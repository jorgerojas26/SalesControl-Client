(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,t){e.exports={loadProducts:function(e){return{type:"LOAD_PRODUCTS",paginatedProducts:e}},setLoading:function(e){return{type:"LOADING",loading:e}}}},16:function(e,t){e.exports={loadCategories:function(e){return{type:"LOAD_CATEGORIES",categories:e}},setActiveCategoryId:function(e){return{type:"SET_ACTIVE_CATEGORY_ID",categoryId:e}},setActiveCategoryName:function(e){return{type:"SET_ACTIVE_CATEGORY_NAME",categoryName:e}}}},39:function(e,t){e.exports={fetchAll:async function(){let e=await fetch("/api/products",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await e.json()},fetchById:async function(e){return(await fetch("/api/products?id="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}})).json()},fetchByName:async function(e){return(await fetch("/api/products?name="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}})).json()}}},44:function(e,t){e.exports={roundUpProductPrice(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}}},45:function(e,t,a){e.exports=a(93)},51:function(e,t,a){},52:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a.n(r),n=a(11),l=a.n(n),o=(a(50),a(51),a(52),a(4)),c=a(3);a(40);r.Component;a(26);r.Component;r.Component;r.Component;var i=a(13),d=a(14),m=a(16);class u extends r.Component{constructor(){super(),this.fetchProducts=this.fetchProducts.bind(this),this.categoryHandler=this.categoryHandler.bind(this)}componentDidMount(){fetch("/api/categories").then(e=>e.json()).then(e=>{e.data.length>0&&(this.props.dispatch(m.loadCategories(e.data)),this.props.dispatch(m.setActiveCategoryId(document.querySelector(".categoryItem, active").getAttribute("categoryId"))),this.props.dispatch(m.setActiveCategoryName(document.querySelector(".categoryItem, active").innerText)))})}categoryHandler(e){e.preventDefault(),e.target.className.includes("active")||(e.target.parentElement.querySelector(".active").classList.remove("active"),e.target.classList.add("active"),this.props.dispatch(m.setActiveCategoryId(e.target.getAttribute("categoryid"))),this.props.dispatch(m.setActiveCategoryName(e.target.innerText)),this.fetchProducts(1,16,e.target.getAttribute("categoryid")))}fetchProducts(e,t,a){this.props.dispatch(d.setLoading(!0)),fetch(`/api/products?page=${e}&limit=${t}&categories=${a}`).then(e=>e.json()).then(e=>{this.props.dispatch(d.loadProducts(e)),this.props.dispatch(d.setLoading(!1))})}render(){return s.a.createElement("div",{className:"col-xs-6 col-sm-12 col-md-12 p-0 mt-0 mt-md-5 productcategoriesContainer"},s.a.createElement("div",{className:"card rounded-0"},s.a.createElement("div",{className:"card-header"},s.a.createElement("h5",{className:"card-title text-danger font-weight-bold"},"Categorias")),s.a.createElement("div",{className:"card-body p-0"},s.a.createElement("div",{className:"list-group"},this.props.categories?this.props.categories.map((e,t)=>0===t?s.a.createElement("li",{onClick:this.categoryHandler,categoryid:e.id,key:e.id,className:"categoryItem list-group-item active btn"},e.name):s.a.createElement("li",{onClick:this.categoryHandler,categoryid:e.id,key:e.id,className:"categoryItem list-group-item btn"},e.name)):s.a.createElement("span",null,"No hay categorias")))))}}Object(i.b)((function(e,t){return{categories:e.categories.data,activeCategory:e.categories.activeCategory}}))(u);var h=a(42);class p extends r.Component{render(){return s.a.createElement("h3",{className:"float-left text-danger mt-2"},this.props.activeCategory)}}var g=Object(i.b)((function(e,t){return{activeCategory:e.categories.activeCategoryName}}))(p);class b extends r.Component{constructor(){super(),this.observer=new IntersectionObserver(this.loadMoreProductsHandler.bind(this)),this.elementToObserve=s.a.createRef()}componentDidMount(){this.fetchProducts(1,16)}componentDidUpdate(){this.elementToObserve.current&&this.observer.observe(this.elementToObserve.current)}fetchProducts(e,t,a=1){this.props.dispatch(d.setLoading(!0)),fetch(`/api/products?page=${e}&limit=${t}&categories=${a}`).then(e=>e.json()).then(e=>{e.data=this.props.products.concat(e.data),this.props.dispatch(d.loadProducts(e)),this.props.dispatch(d.setLoading(!1))})}loadMoreProductsHandler(e){e[0].isIntersecting&&this.props.next&&this.fetchProducts(this.props.next.page,this.props.next.limit,this.props.activeCategory)}render(){if(this.props.products.length>0){let e=this.props.products.map((e,t)=>s.a.createElement("div",{className:"col-6 col-sm-6 col-md-4 col-lg-3 p-0 pr-2 pb-2",key:t},s.a.createElement("div",{className:"card"},s.a.createElement("img",{className:"card-img-top productImage",src:e.imagePath,alt:"Imagen del producto"}),s.a.createElement("div",{className:"card-body"},s.a.createElement("h5",{className:"card-title font-weight-bold overflow-hidden text-truncate text-dark"},e.name),s.a.createElement("h5",{className:"text-danger"},"Bs. ",e.price)),s.a.createElement("div",{className:"card-footer"},s.a.createElement("div",{className:"input-group d-flex justify-content-center"},s.a.createElement("input",{className:"form-control text-center",style:{maxWidth:"35%"},type:"number",defaultValue:"1",name:"numberOfItems",id:"numberOfItems"}),s.a.createElement("input",{className:"bg-dark text-light",type:"button",value:"Comprar"}))))));return this.props.next&&e.push(s.a.createElement("div",{className:"col-xs-12 col-sm-6 col-md-4 col-lg-3 p-0 pr-2 pb-2",key:"contentLoader",ref:this.elementToObserve},s.a.createElement(h.a,{speed:1,viewBox:"0 0 200 400",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb"},s.a.createElement("rect",{x:"0",y:"6",rx:"0",ry:"0",width:"239",height:"250"}),s.a.createElement("rect",{x:"0",y:"292",rx:"0",ry:"0",width:"239",height:"15"}),s.a.createElement("rect",{x:"59",y:"291",rx:"0",ry:"0",width:"2",height:"0"}),s.a.createElement("rect",{x:"0",y:"313",rx:"0",ry:"0",width:"239",height:"15"}),s.a.createElement("rect",{x:"0",y:"361",rx:"0",ry:"0",width:"239",height:"36"})))),e.unshift(s.a.createElement("div",{className:"col-12"},s.a.createElement(g,null))),e}return this.props.loading?s.a.createElement("p",null,"Loading"):s.a.createElement("p",null,"No hay productos")}}Object(i.b)((function(e,t){return{products:e.products.data,next:e.products.next,previous:e.products.previous,loading:e.products.loading,activeCategory:e.categories.activeCategory}}))(b);r.Component;var E=async function(){let e=localStorage.getItem("jwt");return!!e&&fetch("/sessions/isAuthenticated?token="+e).then(e=>e.json()).then(e=>e.auth)};class f extends r.Component{constructor(){super(),this.onSubmitHandler=this.onSubmitHandler.bind(this),this.inputHandler=this.inputHandler.bind(this),this.state={email:null,password:null,logginError:null}}componentDidMount(){E().then(e=>{e&&this.props.history.push("/")})}onSubmitHandler(e){e.preventDefault(),this.setState({logginError:null}),fetch("/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password})}).then(e=>e.json()).then(e=>{e.err?this.setState({logginError:e.err}):(localStorage.setItem("jwt",e.token),this.props.history.push("/"))})}inputHandler(e){this.setState({[e.target.name]:e.target.value})}render(){return s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row h-100"},s.a.createElement("div",{className:"col-10 col-md-5 my-auto mx-auto"},s.a.createElement("form",{onSubmit:this.onSubmitHandler,className:"col-12",action:"/sessions",method:"POST"},s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{onChange:this.inputHandler,type:"text",className:"form-control",name:"email",id:"email",placeholder:"Email"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{onChange:this.inputHandler,type:"password",className:"form-control",name:"password",id:"password",placeholder:"Password"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Enviar")),s.a.createElement("div",{className:"form-group"},s.a.createElement("p",{className:"text-danger"},this.state.logginError))))))}}var N=f;const y="/api/categories";var v={fetchAll:async function(){let e=await fetch(y,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await e.json()},fetchById:async function(e){let t=await fetch(y+"?id="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},fetchByName:async function(e){let t=await fetch(y+"?name="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},create:async function(e){let t=await fetch(y,{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},update:async function(e){let t=await fetch(y+"/"+e.id,{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify()});return await t.json()}},S=a(1),D=a.n(S);a(5);class C extends r.Component{constructor(){super(),this.state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,categoryName:null,categoryAction:null,selectedRowData:null},this.submitHandler=this.submitHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.categoriesTable=s.a.createRef(),this.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#categoryModal"},action:(e,t,a,r)=>{D()(".modal-title").text("Add new category"),D()("#categoryName").val(""),this.setState({categoryAction:"Add"})}},this.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#categoryModal"},action:(e,t,a,r)=>{let s=t.row({selected:!0}).data();D()(".modal-title").text("Edit category"),D()("#categoryName").val(s.name),this.setState({categoryAction:"Edit",selectedRowData:s})}}}async componentDidMount(){let e=await v.fetchAll();e.data?D()(this.categoriesTable.current).DataTable({data:e.data,columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"Fecha creaci\xf3n",data:"createdAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single"}):this.setState({fetchMessage:e.toString()})}changeHandler(e){this.setState({[e.target.name]:e.target.value})}submitHandler(e){e.preventDefault();var t=null;this.setState({submitLoading:!0},async()=>{if("Add"==this.state.categoryAction)t=await v.create({name:this.state.categoryName});else if("Edit"==this.state.categoryAction){t=await v.edit({id:this.state.selectedRowData.id,name:this.state.categoryName}),D()(this.categoriesTable.current).DataTable().rows().data().map((e,t)=>{if(e.id==this.state.selectedRowData.id){let e=D()(this.categoriesTable.current).DataTable().row(t),a=e.data();e.data({...a,name:this.state.categoryName})}})}t.error?this.setState({submitMessage:t.error,submitMessageType:"Error",submitLoading:!1}):(this.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout(()=>{this.setState({submitMessage:null,submitMessageType:null})},3e3))})}render(){return s.a.createElement("div",null,this.state.fetchMessage&&s.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Categor\xedas"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("table",{ref:this.categoriesTable,id:"categoriesTable",name:"categoriesTable",className:"table table-bordered"}))),s.a.createElement("div",{className:"modal fade",id:"categoryModal",tabindex:"-1","aria-labelledby":"categoryModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"categoryModalLabel"},"Add new category"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("form",{onSubmit:this.submitHandler},s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"name"},"Category Name: "),s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"text",name:"categoryName",id:"categoryName",required:!0}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&s.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&s.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}var w=C;var T={fetchAll:async function(){let e=await fetch("/api/clients",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await e.json()},fetchById:async function(e){let t=await fetch("/api/clients?id="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},fetchByName:async function(e){let t=await fetch("/api/clients?name="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},create:async function(e){let t=await fetch("/api/clients",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},update:async function(e){let t=await fetch("/api/clients/"+e.id,{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}};a(5);class x extends r.Component{constructor(){super(),this.state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,name:null,cedula:null,phoneNumber:null,selectedRowData:null,clientAction:null},this.submitHandler=this.submitHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.clientTable=s.a.createRef(),this.customSelectRef=s.a.createRef(),this.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#clientModal"},action:(e,t,a,r)=>{D()(".modal-title").text("Add new client"),D()("#name").val(""),D()("#cedula").val(""),D()("#phoneNumber").val(""),this.setState({clientAction:"Add"})}},this.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#clientModal"},action:(e,t,a,r)=>{let s=t.row({selected:!0}).data();D()(".modal-title").text("Edit client"),D()("#name").val(s.name),D()("#cedula").val(s.cedula),D()("#phoneNumber").val(s.phoneNumber),this.setState({clientAction:"Edit",selectedRowData:s,name:s.name,cedula:s.cedula,phoneNumber:s.phoneNumber})}}}async componentDidMount(){let e=await T.fetchAll();e.data?(console.log(e.data),D()(this.clientTable.current).DataTable({data:e.data,columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"C\xe9dula",data:"cedula"},{title:"Tel\xe9fono",data:"phoneNumber"},{title:"Fecha creaci\xf3n",data:"createdAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single",order:[0,"DESC"]})):this.setState({fetchMessage:e.toString()})}changeHandler(e){this.setState({[e.target.name]:e.target.value})}optionChangeHandler(e,t){this.setState({selectedClient:e})}submitHandler(e){e.preventDefault();var t=null;this.setState({submitLoading:!0},async()=>{if("Add"==this.state.clientAction)t=await T.create({name:this.state.name,cedula:this.state.cedula,phoneNumber:this.state.phoneNumber});else if("Edit"==this.state.clientAction){console.log(this.state),t=await T.update({id:this.state.selectedRowData.id,name:this.state.name,cedula:this.state.cedula,phoneNumber:this.state.phoneNumber}),D()(this.clientTable.current).DataTable().rows().data().map((e,t)=>{if(e.id==this.state.selectedRowData.id){let e=D()(this.clientTable.current).DataTable().row(t),a=e.data();e.data({...a,name:this.state.name,cedula:this.state.cedula,phoneNumber:this.state.phoneNumber})}})}t&&t.error?this.setState({submitMessage:JSON.stringify(t.error),submitMessageType:"Error",submitLoading:!1}):(this.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout(()=>{this.setState({submitMessage:null,submitMessageType:null})},3e3))})}render(){return s.a.createElement("div",null,this.state.fetchMessage&&s.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Clientes"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("table",{ref:this.clientTable,id:"clientTable",name:"clientTable",className:"table table-bordered"}))),s.a.createElement("div",{className:"modal fade",id:"clientModal",tabindex:"-1","aria-labelledby":"clientModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"clientModalLabel"},"Add new client"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("form",{onSubmit:this.submitHandler},s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Nombre: "),s.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"name",id:"name",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"C\xe9dula: "),s.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"cedula",id:"cedula",required:!0})),s.a.createElement("label",{htmlFor:"debtTotal"},"Tel\xe9fono: "),s.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"phoneNumber",id:"phoneNumber"})),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&s.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&s.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}var H=x;const R=a(1),I=(a(5),a(75));a(82),a(85),a(86),a(87),a(88),a(89),window.JSZip=I;class M extends r.Component{constructor(e){super(),this.recordsTable=s.a.createRef(),this.modal=s.a.createRef(),this.state={selectedRowData:null,sourceURL:e.sourceURL}}changeSourceURL(e){let t=this.recordsTable.current;R(t).DataTable().ajax.url(e).load()}componentDidMount(){let e=this.recordsTable.current,t=R(e);var a=this;this.props.asyncTable?(t=t.DataTable({initComplete:function(){this.api().columns().every((function(){var e=this;"createdAt"==e.dataSrc()||"updatedAt"==e.dataSrc()?R(this.header()).append("<br><input class='p-0 m-0 h-100' type='date' />"):R(this.header()).append("<br><input class='p-0 m-0 h-100' type='text' placeholder='Filtrar'/>"),R("input",this.header()).on("keyup change",(function(){let r=e.dataSrc().split("."),s="";r.forEach((e,t)=>{0==t?s=r[0]:s+=r[t].charAt(0).toUpperCase()+r[t].slice(1)}),a.props.sourceURL.includes("?")?t.ajax.url(`${a.props.sourceURL}&${s}=${this.value.trim()}`).load():t.ajax.url(`${a.props.sourceURL}?${s}=${this.value.trim()}`).load()}))}))},footerCallback:function(e,t){var a=this.api();a.columns().every((function(){if("grossTotalDollars"==this.dataSrc()){let e=a.column(3).data().reduce((function(e,t){return e+t}),0),t=a.column(3,{page:"current"}).data().reduce((function(e,t){return e+t}),0);e?R(this.footer()).html(`${Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)} <br>\n                                            <span class="text-danger">(${Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)} Total)</span>`):R(this.footer()).html("")}if("grossTotalBs"==this.dataSrc()){let e=a.column(4).data().reduce((function(e,t){return e+t}),0),t=a.column(4,{page:"current"}).data().reduce((function(e,t){return e+t}),0);t?R(this.footer()).html(`${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t)} <br>\n                                        <span class="text-danger">(${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e)} Total)</span>`):R(this.footer()).html("")}if("netIncomeDollars"==this.dataSrc()){let e=a.column(5).data().reduce((function(e,t){return e+t}),0),t=a.column(5,{page:"current"}).data().reduce((function(e,t){return e+t}),0);t?R(this.footer()).html(`${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t)} <br>\n                                        <span class="text-danger">(${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e)} Total)</span>`):R(this.footer()).html("")}if("netIncomeBs"==this.dataSrc()){let e=a.column(6).data().reduce((function(e,t){return e+t}),0),t=a.column(6,{page:"current"}).data().reduce((function(e,t){return e+t}),0);t?R(this.footer()).html(`${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t)} <br>\n                                        <span class="text-danger">(${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e)} Total)</span>`):R(this.footer()).html("")}}))},dom:"Brltip",select:"single",buttons:[{text:"Imprimir",name:"imprimir",className:"btn btn-secondary float-right",extend:"print",messageTop:"Lista de precios",footer:!0,title:a.props.sourceURL.includes("productss")?"Lista de precios":"",customize:function(e){R(e.document.body).find("#messageTop").css("text-align","center"),e.document.body.querySelector("table").querySelector("thead").querySelectorAll("input").forEach(e=>{e.style.display="none"})},exportOptions:{stripHtml:!1,modifier:{page:"all"},columns:a.props.sourceURL.includes("products")?[1,3]:":visible"}}].concat(this.props.actions.map(e=>"add"==e?{text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#exampleModal"},action:function(){a.props.setModalAction("add")}}:"edit"==e?{text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#exampleModal"},action:(e,t,r,s)=>{var n=t.row({selected:!0}).data();a.props.setSelectedRowData(n),a.props.setModalAction("edit")}}:"delete"==e?{text:"Delete",name:"delete",className:"btn btn-danger",extend:"selected",action:function(e,t,r,s){var n=t.row({selected:!0}).data();1==window.confirm("\xbfEst\xe1 seguro que desea eliminar este registro?")&&fetch(`${a.props.sourceURL}/${n.id}`,{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then(e=>{204==e.status?t.ajax.reload():e.json().then(e=>{a.setState({error:e})})}).catch(e=>{a.setState({error:e})})}}:"date-range"==e?{text:"Reload",name:"reload",className:"btn btn-primary",action:function(e,t,r,s){t.ajax.url(a.state.sourceURL).load()}}:"discount"==e?[{text:"Apply Discount",name:"discountButton",className:"btn btn-primary",attr:{"data-toggle":"modal","data-target":"#discountModal"},extend:"selected",action:function(e,t,r,s){var n=t.row({selected:!0}).data();a.props.setSelectedRowData(n),a.props.setModalAction("applyDiscount")}},{text:"Cancel Discount",name:"cancelDiscountButton",className:"btn btn-danger",extend:"selected",action:function(e,t,a,r){if(1==window.confirm("\xbfSeguro que desea eliminar el descuento?")){let e=t.row({selected:!0}).data().discount[0].id;fetch("/api/discounts/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")},method:"DELETE"}).then(e=>{204==e.status&&t.ajax.reload()})}}}]:void 0)),serverSide:!0,ajax:{url:this.state.sourceURL,dataSrc:function(e){return"object"==typeof e.count&&e.data.forEach((t,a)=>{t.productId==e.count[a].id&&(t.count=e.count[a].count)}),a.props.sourceURL.includes("/api/sales")&&a.props.sourceURL.includes("group=true")?e.data.forEach((e,t)=>{e.product=e.product[0],e.grossTotalBs=e.grossTotalDollars*e.dolarReference,e.netIncomeDollars=e.grossTotalDollars*(e.product.profitPercent/100),e.netIncomeBs=e.netIncomeDollars*e.dolarReference}):a.props.sourceURL.includes("/api/supplyings")&&a.props.sourceURL.includes("group=true")&&e.data.forEach((e,t)=>{e.grossTotalBs=e.grossTotalDollars*e.dolarReference}),e.data},headers:{Authorization:"Bearer "+localStorage.getItem("jwt")},data:function(e){-1!=e.length?(e.page=e.start/e.length+1,e.limit=e.length):(e.page=1,e.limit=0)},error:function(e,t,a){}},paging:!0,lengthMenu:[[10,25,50,100,1e15],[10,25,50,100,"All"]],pageLength:this.props.sourceURL.includes("group=true")?1e15:10,columns:this.props.columns,columnDefs:this.props.sourceURL.includes("products")?[{width:"30%",targets:1}]:null,ordering:!1,order:a.props.sorting||[[0,"desc"]]}),this.props.actions.includes("date-range")&&(R(".dt-buttons").append('<div class="d-flex justify-content-end">\n                    <label class="mr-2" for="dateFrom">From:</label>\n                    <input type="date" id="dateFrom" name="dateFrom">\n                    <label class="mr-2 ml-2" for="dateTo">To:</label>\n                    <input type="date" id="dateTo" name="dateTo">\n                    </div>'),R(".dt-buttons input[type=date]").on("change",(function(){t.ajax.url(`${a.state.sourceURL}?from=${R("#dateFrom").val()}&to=${R("#dateTo").val()}`).load()}))),R("#resourceTable tbody").on("click","td.details-control",(function(){var e=R(this).closest("tr"),r=t.row(e);r.child.isShown()?(r.child.hide(),e.removeClass("shown")):(r.child(a.props.childFormat(r.data())).show(),e.addClass("shown"))}))):t=t.DataTable({dom:"",data:this.props.data,columns:this.props.columns}),this.modal.current.addEventListener("focus",()=>{this.modal.current.querySelector(".form-group").children[0].focus()})}render(){return s.a.createElement("div",{className:"bg-light table-responsive"},s.a.createElement("table",{id:"resourceTable",className:"table table-bordered",ref:this.recordsTable},s.a.createElement("thead",null),s.a.createElement("tbody",null),s.a.createElement("tfoot",null,s.a.createElement("tr",null,this.props.columns.map((e,t)=>s.a.createElement("td",{key:t}))))),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error),s.a.createElement("div",{ref:this.modal,className:"modal",id:"exampleModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},s.a.createElement("div",{className:"modal-content"},this.props.modalStructure))))}}var A=M,P=a(22);class k extends r.Component{constructor(){super(),this.state={options:[]},this.searchHandler=this.searchHandler.bind(this)}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}searchHandler(e,t){fetch(this.props.sourceURL||"/api/products?name="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then(e=>e.json()).then(e=>{e.data.length>0&&(e.data.forEach(e=>{e.value=e.name,e.imagePath?e.label=[s.a.createElement("img",{className:"img img-fluid",style:{maxWidth:"40px"},src:e.imagePath}),`${e.name} (${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(this.roundToNiceNumber(e.price*this.props.dolarReference))})`]:e.label=`${e.name} (${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(this.roundToNiceNumber(e.price*this.props.dolarReference))})`}),t(e.data))})}render(){return s.a.createElement(P.a,{loadOptions:this.searchHandler,defaultOptions:!0,placeholder:"Buscar",autoFocus:!0,inputId:"selectedProduct",isMulti:this.props.isMulti,isClearable:!0,ref:this.props.innerRef,name:this.props.name,onChange:this.props.changeHandler,value:this.props.value})}}var B=k;a(15);a(5);class F extends r.Component{constructor(){super(),this.state={selectedCategories:null,name:null,productImageFile:null,profitPercent:null,success:null,error:null,modalAction:null,discountPercent:null,discountStartDate:null,discountEndDate:null,selectedRowData:null},this.submitHandler=this.submitHandler.bind(this),this.discountSubmitHandler=this.discountSubmitHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.setModalAction=this.setModalAction.bind(this),this.setSelectedRowData=this.setSelectedRowData.bind(this),this.CustomSelectRef=s.a.createRef(),this.productForm=s.a.createRef(),this.closeButton=s.a.createRef()}setModalAction(e){this.setState({modalAction:e})}setSelectedRowData(e){let t=[];e.category.forEach(e=>{t.push({id:e.id,label:e.name,value:e.name})}),this.setState({selectedRowData:e,selectedCategories:t,name:e.name,profitPercent:e.profitPercent},()=>{D()("#name").val(this.state.selectedRowData.name),D()("#profitPercent").val(this.state.selectedRowData.profitPercent)})}optionChangeHandler(e,t){this.setState({selectedCategories:e})}changeHandler(e){this.setState({[e.target.name]:"file"==e.target.type?e.target.files[0]:e.target.value})}submitHandler(e){e.preventDefault();var t="";this.state.selectedCategories?this.state.selectedCategories.forEach((e,a)=>{t+=e.id,a!=this.state.selectedCategories.length-1&&(t+=",")}):alert("Seleccione las categor\xedas");var a=new FormData;a.append("productImageFile",this.state.productImageFile),a.append("name",this.state.name),a.append("profitPercent",this.state.profitPercent),a.append("categories",t),fetch("add"==this.state.modalAction?"/api/products":"/api/products/"+this.state.selectedRowData.id,{method:"add"==this.state.modalAction?"POST":"PATCH",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),Accept:"application/json"},body:a}).then(e=>{200==e.status?(this.setState({success:"El producto se ha registrado con exito",productImageFile:null}),this.productForm.current.reset(),this.closeButton.current.click(),D()("#resourceTable").DataTable().ajax.reload(null,!1)):409==e.status&&e.json().then(e=>{this.setState({error:e.error||e.err})})}).catch(e=>{this.setState({error:e})})}discountSubmitHandler(e){e.preventDefault(),this.state.discountPercent&&this.state.discountStartDate&&this.state.discountEndDate?fetch("/api/discounts",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({productId:this.state.selectedRowData.id,percent:this.state.discountPercent,startDate:this.state.discountStartDate,endDate:this.state.discountEndDate})}).then(e=>{200==e.status?this.setState({success:"Se ha registrado con \xe9xito"}):e.json().then(e=>{this.setState({error:e.error||e.err})})}):alert("Rellene todos los campos")}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Productos"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,setSelectedRowData:this.setSelectedRowData,setModalAction:this.setModalAction,sourceURL:"/api/products",columns:[{title:"ID",data:"id"},{render:function(e,t,a,r){return a.imagePath?`<span class="p-0"><img class="img-responsive m-0 p-0" src="${a.imagePath}" style="max-width:40px;"></img>${e}</span>`:e},title:"Nombre",data:"name"},{title:"Precio $",data:"price"},{render:e=>Intl.NumberFormat("es-Ve",{style:"currency",currency:"VES"}).format(this.roundToNiceNumber(e*this.props.dolarReference)),title:"Precio Bs",data:"price"},{render:function(e){return e+"%"},title:"Porcentaje de Ganancia",data:"profitPercent"},{render:function(e,t,a,r){let s=e.map(e=>e.percent);return s.length?s+"%":"0%"},title:"Descuento",data:"discount"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],actions:["add","edit","delete","discount"],modalStructure:s.a.createElement("form",{ref:this.productForm,onSubmit:this.submitHandler,className:"float-left"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Product"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"name"},"Product Name: "),s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"text",name:"name",id:"name",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"profitPercent"},"Profit Percent: "),s.a.createElement("div",{className:"input-group"},s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("div",{className:"input-group-text"},"%")),s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.1",name:"profitPercent",id:"profitPercent",required:!0}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"productImageFile"},"Imagen: "),s.a.createElement("div",{className:"custom-file"},s.a.createElement("input",{onChange:this.changeHandler,type:"file",className:"custom-file-input",id:"productImageFile",name:"productImageFile"}),s.a.createElement("label",{className:"custom-file-label",htmlFor:"image"},"Choose file"))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"price"},"Categor\xedas: "),s.a.createElement(B,{sourceURL:"/api/categories",isMulti:!0,innerRef:this.CustomSelectRef,changeHandler:this.optionChangeHandler,value:this.state.selectedCategories,required:!0}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{ref:this.closeButton,type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&s.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error))}),s.a.createElement("div",{id:"discountModal",className:"modal",tabIndex:"-1"},s.a.createElement("div",{className:"modal-dialog"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title"}),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("form",{onSubmit:this.discountSubmitHandler},s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"discountPercent"},"Discount Percent: "),s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.01",min:"0",name:"discountPercent",id:"discountPercent",required:!0}),s.a.createElement("div",{className:"input-group-append"},s.a.createElement("div",{className:"input-group-text"},"%"))),s.a.createElement("label",{htmlFor:"discountStartDate"},"Start Date:"),s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"date",name:"discountStartDate",id:"discountStartDate",required:!0})),s.a.createElement("label",{htmlFor:"discountEndDate"},"End Date:"),s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"date",name:"discountEndDate",id:"discountEndDate",required:!0})))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&s.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error))))))))}}var j=F;class L extends r.Component{constructor(){super(),this.submitHandler=this.submitHandler.bind(this),this.roundToNiceNumber=this.roundToNiceNumber.bind(this),this.childFormat=this.childFormat.bind(this)}submitHandler(e){e.preventDefault(),console.log("hola")}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}childFormat(e){let t="";return e.saleProducts.forEach(e=>{t+=`\n            <div class='form-row align-items-center'>\n                    <div class="col-1">\n                        <label for="productId">Product ID</label>\n                        <input class="form-control" id="productId" value="${e.productId}" disabled/>\n                    </div>\n                    <div class="col-4">\n                        <label for="productName">Name</label>\n                        <input class="form-control" id="productName" value="${e.product[0].name}" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productPrice">Price $</label>\n                        <input class="form-control" id="productPrice" value="$${e.price}" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productPriceBs">Price Bs</label>\n                        <input class="form-control" id="productPriceBs" value="Bs.S ${this.roundToNiceNumber(e.price*e.dolarReference)}" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="discount">Discount</label>\n                        <input class="form-control" id="discount" value="${e.discount}%" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productQuantity">Quantity</label>\n                        <input class="form-control" id="productQuantity" value="${e.quantity}" disabled/>\n                    </div>\n                    <div class="col-2">\n                        <label for="dolarValue">Dolar value</label>\n                        <input class="form-control" id="dolarValue" value="${Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.dolarReference)}" disabled/>\n                    </div>\n            </div>\n            `}),t+="",t}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Ventas"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,childFormat:this.childFormat,sourceURL:"/api/sales",columns:[{title:"ID",data:"id"},{title:"Productos",className:"details-control",orderable:!1,data:"productName",defaultContent:'<button class="btn btn-success">Ver Productos</button>'},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["edit","delete"]}))))}}var $=L;a(5);class q extends r.Component{constructor(){super(),this.state={name:null,rif:null,success:null,error:null},this.submitHandler=this.submitHandler.bind(this),this.inputChangeHandler=this.inputChangeHandler.bind(this),this.setModalAction=this.setModalAction.bind(this)}setModalAction(e){this.setState({modalAction:e})}submitHandler(e){e.preventDefault(),this.state.name&&this.state.rif&&fetch("/api/suppliers",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({name:this.state.name,rif:this.state.rif})}).then(e=>{200==e.status?(this.setState({success:"Se ha registrado de forma exitosa."}),D()("#resourceTable").DataTable().draw()):e.text().then(e=>{this.setState({error:e})})})}inputChangeHandler(e){this.setState({[e.target.name]:e.target.value})}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Proveedores"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,setModalAction:this.setModalAction,sourceURL:"/api/suppliers",columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"RIF",data:"rif"},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["add","edit","delete"],modalStructure:s.a.createElement("form",{onSubmit:this.submitHandler,className:"float-left"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplier"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"name"},"Supplier Name: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"name",id:"name",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"rif"},"RIF: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"rif",id:"rif",required:!0}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&s.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}var Y=q;a(5);class O extends r.Component{constructor(){super(),this.state={supplier:null,product:null,price:null,quantity:null,success:null,error:null},this.submitHandler=this.submitHandler.bind(this),this.supplierChangeHandler=this.supplierChangeHandler.bind(this),this.productChangeHandler=this.productChangeHandler.bind(this),this.inputChangeHandler=this.inputChangeHandler.bind(this),this.setModalAction=this.setModalAction.bind(this),this.supplierSelect=s.a.createRef(),this.productSelect=s.a.createRef(),this.supplyingForm=s.a.createRef()}setModalAction(e){this.setState({modalAction:e})}supplierChangeHandler(e){this.setState({supplier:e})}productChangeHandler(e){this.setState({product:e})}inputChangeHandler(e){this.setState({[e.target.name]:e.target.value})}submitHandler(e){e.preventDefault(),this.state.supplier&&this.state.product&&this.state.price&&this.state.quantity?fetch("/api/supplyings",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({supplierId:this.state.supplier.id,productId:this.state.product.id,price:this.state.price,quantity:this.state.quantity,dolarReference:this.props.dolarReference})}).then(e=>{200==e.status?(this.setState({success:"Se ha registrado el abastecimiento con \xe9xito"}),this.supplyingForm.current.reset(),D()("#resourceTable").DataTable().draw()):e.text().then(e=>{this.setState({error:e})})}):alert("Por favor rellene todos los campos")}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Abastecimiento"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,setModalAction:this.setModalAction,sourceURL:"/api/supplyings",columns:[{title:"ID",data:"id"},{title:"ID Proveedor",data:"supplierId"},{title:"Nombre Proveedor",data:"supplier.name"},{title:"ID Product",data:"productId"},{title:"Nombre Producto",data:"product.name"},{render:function(e){return"$"+e},title:"Precio de Compra",data:"price"},{render:function(e){return e>1?e+" Unidades":e+" Unidad"},title:"Cantidad",data:"quantity"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],actions:["add","edit","delete"],modalStructure:s.a.createElement("form",{ref:this.supplyingForm,onSubmit:this.submitHandler,className:"float-left"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplying"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"supplierId"},"Supplier ID: "),s.a.createElement(B,{sourceURL:"/api/suppliers",isMulti:!1,innerRef:this.supplierSelect,changeHandler:this.supplierChangeHandler,required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"productId"},"Product ID: "),s.a.createElement(B,{isMulti:!1,innerRef:this.productSelect,changeHandler:this.productChangeHandler,required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"price"},"Price: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"number",step:"0.00000000000000001",name:"price",id:"price",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"quantity"},"Quantity: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"number",step:"0.00000000000000001",name:"quantity",id:"quantity",required:!0}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&s.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}var U=O;class V extends r.Component{constructor(){super(),this.state={email:null,password:null,permissions:null,success:null,error:null},this.submitHandler=this.submitHandler.bind(this),this.inputChangeHandler=this.inputChangeHandler.bind(this),this.form=s.a.createRef()}submitHandler(e){e.preventDefault(),this.state.email&&this.state.password&&this.state.permissions&&fetch("/api/users",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password,permissions:this.state.permissions})}).then(e=>{200==e.status?(this.setState({success:"Se ha registrado con \xe9xito"}),this.form.current.reset(),D()("resourceTable").DataTable().draw()):e.text().then(e=>{this.setState({error:e})})})}inputChangeHandler(e){this.setState({[e.target.name]:e.target.value})}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Usuarios"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,sourceURL:"/api/users",columns:[{title:"ID",data:"id"},{title:"Email",data:"email"},{title:"Permisos",data:"permissions"},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["add","delete"],modalStructure:s.a.createElement("form",{ref:this.form,onSubmit:this.submitHandler,className:"float-left"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplier"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"email"},"Email: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"email",id:"email",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"password"},"Password: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"password",name:"password",id:"password",required:!0})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{htmlFor:"permissions"},"Permissions: "),s.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"permissions",id:"permissions",required:!0}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&s.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&s.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}var z=V;class G extends r.Component{constructor(){super(),this.clickHandler=this.clickHandler.bind(this),this.logout=this.logout.bind(this)}logout(){localStorage.removeItem("jwt")}clickHandler(e){this.setState({activeNavLink:e.target.innerText})}render(){return s.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark flex-lg-column flex-xl-row"},s.a.createElement("a",{className:"navbar-brand text-danger",href:"/"},"Supermercado Melquisedec"),s.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},s.a.createElement("span",{className:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse row p-0 m-0",id:"navbarSupportedContent"},s.a.createElement("ul",{className:"navbar-nav flex-lg-row mx-auto container-fluid p-0 m-0"},s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/control-de-ventas"},s.a.createElement("span",{className:"d-md-inline"},"Control de Ventas"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/inventario"},s.a.createElement("span",{className:"d-md-inline"},"Inventario"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/reportes"},s.a.createElement("span",{className:"d-md-inline"},"Reportes"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/deuda"},s.a.createElement("span",{className:"d-md-inline"},"Deuda"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/categorias"},s.a.createElement("span",{className:"d-md-inline"},"Categor\xedas"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/clientes"},s.a.createElement("span",{className:"d-md-inline"},"Clientes"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/productos"},s.a.createElement("span",{className:"d-md-inline"},"Productos"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/ventas"},s.a.createElement("span",{className:"d-md-inline"},"Ventas"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/abastecimiento"},s.a.createElement("span",{className:"d-md-inline"},"Abastecimiento"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/proveedores"},s.a.createElement("span",{className:"d-md-inline"},"Proveedores"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link",onClick:this.clickHandler,to:"/usuarios"},s.a.createElement("span",{className:"d-md-inline"},"Usuarios"))),s.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},s.a.createElement(o.b,{className:"nav-link btn btn-danger px-0",onClick:this.logout,to:"/signin"},"Cerrar Sesi\xf3n")))))}}var J=G;class _ extends r.Component{constructor(){super(),this.state={selectedProduct:null,addedProducts:[],subtotalDollars:null,subtotalBs:null,totalDollars:null,totalBs:null,quantity:1,stockError:"",error:"",success:"",submittingSale:!1},this.productsHandler=this.productsHandler.bind(this),this.submitHandler=this.submitHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.onChangeHandler=this.onChangeHandler.bind(this),this.clickHandler=this.clickHandler.bind(this),this.saleSubmitButton=s.a.createRef(),this.sendSaleForm=s.a.createRef(),this.quantityInput=s.a.createRef(),this.CustomSelectRef=s.a.createRef(),this.productsTableDiv=s.a.createRef(),this.productsTable=s.a.createRef()}componentDidMount(){let e=document.body.getBoundingClientRect(),t=this.productsTableDiv.current.getBoundingClientRect(),a=e.height-t.top-t.height-30;this.productsTableDiv.current.style.maxHeight=a,document.body.addEventListener("keyup",e=>{let t=e.key;e.ctrlKey&&"Enter"==t&&this.saleSubmitButton.current&&this.saleSubmitButton.current.click()})}optionChangeHandler(e,t){"select-option"==t.action&&(this.quantityInput.current.focus(),this.quantityInput.current.select()),this.setState({selectedProduct:e})}onChangeHandler(e){"quantityInput"==e.target.id?this.setState({quantity:new Number(e.target.value)}):this.setState({[e.target.name]:e.target.value})}productsHandler(e){e.preventDefault(),null!=this.state.selectedProduct?fetch("/api/inventory/"+this.state.selectedProduct.id,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then(e=>e.json()).then(e=>{let t=parseFloat(e.data[0].stock);if(t>0&&t>=this.state.quantity){let e=this.state.selectedProduct,t={},r=0;e.discount.length&&(r=e.discount[0].percent),e.discount=r,e.quantity=this.state.quantity||1,e.totalDollars=e.price*e.quantity-e.price*(r/100),e.priceBs=this.roundToNiceNumber(e.price*this.props.dolarReference),e.totalBs=this.roundToNiceNumber(e.priceBs*e.quantity-e.priceBs*(r/100)),r?(e.totalFormattedDollars=s.a.createElement("span",{className:r?"text-danger":""},Intl.NumberFormat("es-VE",{style:"currency",currency:"USD"}).format(e.totalDollars)+` (-${r}%)`),e.totalFormattedBs=s.a.createElement("span",{className:r?"text-danger":""},Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.totalBs)+` (-${r}%)`)):(e.totalFormattedDollars=Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.totalDollars),e.totalFormattedBs=Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.totalBs)),t={id:e.id,name:e.name,price:e.price,priceBs:e.priceBs,quantity:e.quantity,totalDollars:e.totalDollars,totalBs:e.totalBs,imagePath:e.imagePath,totalFormattedDollars:e.totalFormattedDollars,totalFormattedBs:e.totalFormattedBs,discount:e.discount},this.CustomSelectRef.current.select.state.value=[],this.quantityInput.current.value=1,this.CustomSelectRef.current.focus();let n=!1;if(this.state.addedProducts.forEach(e=>{t.id==e.id&&(n=!0,e.quantity+=t.quantity)}),n){var a=this.state.addedProducts.findIndex(e=>e.id===t.id);this.setState({addedProducts:[...this.state.addedProducts.slice(0,a),Object.assign({},this.state.addedProducts[a],{...t}),...this.state.addedProducts.slice(a+1)],quantity:1,selectedProduct:null,stockError:""},(function(){console.log(this.state.addedProducts);let e=0,t=0;this.state.addedProducts.map(a=>{e+=parseFloat(a.totalDollars),t+=parseFloat(a.totalBs)}),this.setState({subtotalDollars:e,subtotalBs:t,totalDollars:e,totalBs:t})}))}else this.setState({addedProducts:this.state.addedProducts.concat(t),quantity:1,selectedProduct:null,stockError:""},(function(){let e=0,t=0;this.state.addedProducts.map(a=>{e+=parseFloat(a.totalDollars),t+=parseFloat(a.totalBs)}),this.setState({subtotalDollars:e,subtotalBs:t,totalDollars:e,totalBs:t}),this.productsTable.current.parentElement.scrollTop=this.productsTable.current.scrollHeight}))}else this.setState({stockError:"No hay productos suficientes en el inventario"})}):this.setState({stockError:"Seleccione un producto"})}clickHandler(e){let t=[],a=0,r=0;this.state.addedProducts.forEach(s=>{s.id!=e.currentTarget.parentElement.parentElement.getAttribute("productid")?t.push(s):(a+=s.totalDollars,r+=s.totalBs)}),this.setState({addedProducts:t,subtotalDollars:this.state.subtotalDollars-a,subtotalBs:this.state.subtotalBs-r,totalDollars:this.state.totalDollars-a,totalBs:this.state.totalBs-r}),this.CustomSelectRef.current.focus()}submitHandler(){this.state.addedProducts.length?this.state.submittingSale?this.setState({error:"Se est\xe1 ejecutando una venta, por favor espere..."}):this.setState({submittingSale:!0},()=>{let e=[];this.state.addedProducts.forEach(t=>{e.push({id:t.id,quantity:t.quantity,price:t.price,dolarReference:this.props.dolarReference,discount:t.discount})}),fetch("/api/sales",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({products:e})}).then(e=>e.json()).then(e=>{e.err||e.error?this.setState({error:e.err}):(this.setState({success:"La venta se ha realizado con \xe9xito",selectedProduct:null,addedProducts:[],subtotalDollars:null,subtotalBs:null,totalDollars:null,totalBs:null,quantity:1,stockError:"",error:"",submittingSale:!1}),setTimeout(()=>{this.setState({success:""})},3e3),this.CustomSelectRef.current.select.state.value=[],this.quantityInput.current.value=1,this.CustomSelectRef.current.focus(),this.saleSubmitButton.current.disabled=!1)})}):this.setState({stockError:"Seleccione un producto"})}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}render(){return s.a.createElement("div",{className:"container-fluid",id:"container"},s.a.createElement("div",{className:"row d-none d-lg-inline-block"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger"},"Control de Ventas"))),s.a.createElement("div",{className:"row mt-0 mt-lg-5"},s.a.createElement("div",{className:"col-12"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12"},s.a.createElement("span",{className:"text-danger"},this.state.stockError),s.a.createElement("span",{className:"text-danger h3"},this.state.error),s.a.createElement("span",{className:"text-success h3"},this.state.success))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12"})),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12"},s.a.createElement("form",{className:"",onSubmit:this.productsHandler},s.a.createElement("div",{className:"row mb-3"},s.a.createElement("div",{className:"col-12 col-lg-7 mt-2"},s.a.createElement(B,{dolarReference:this.props.dolarReference,isMulti:!1,innerRef:this.CustomSelectRef,changeHandler:this.optionChangeHandler,name:"ProductSelect"})),s.a.createElement("div",{className:"col-12 col-lg-3 mt-2"},s.a.createElement("input",{onChange:this.onChangeHandler,ref:this.quantityInput,step:"0.001",type:"number",className:"form-control",placeholder:"Cantidad",id:"quantity",name:"quantity",defaultValue:"1"})),s.a.createElement("div",{className:"col-12 col-lg-2 mt-2"},s.a.createElement("input",{type:"submit",className:"form-control btn btn-info",value:"Enviar"})))))))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-lg-2"},s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{ref:this.saleSubmitButton,onClick:this.submitHandler,type:"button",className:"form-control btn btn-primary",value:"Procesar venta"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{ref:this.saleSubmitButton,onClick:this.submitHandler,type:"button",className:"form-control btn btn-warning",value:"Enviar a deuda"}))),s.a.createElement("div",{className:"col-12 col-lg-10"},s.a.createElement("div",{ref:this.productsTableDiv,className:"table-responsive"},s.a.createElement("table",{ref:this.productsTable,className:"table table-dark table-striped overflow-auto"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{scope:"col"},"Count"),s.a.createElement("th",{scope:"col"},"Product ID"),s.a.createElement("th",{scope:"col"},"Nombre"),s.a.createElement("th",{scope:"col"},"Precio $"),s.a.createElement("th",{scope:"col"},"Precio Bs"),s.a.createElement("th",{scope:"col"},"Cantidad"),s.a.createElement("th",{scope:"col"},"Total",s.a.createElement("span",{className:"font-weight-bold text-warning"}," "+Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(this.state.totalDollars))),s.a.createElement("th",{scope:"col"},"Total",s.a.createElement("span",{className:"font-weight-bold text-warning"}," "+Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(this.state.totalBs))))),s.a.createElement("tbody",null,this.state.addedProducts.map((e,t)=>s.a.createElement("tr",{key:t,productid:e.id},s.a.createElement("th",null,t+1),s.a.createElement("th",null,e.id),s.a.createElement("th",null,s.a.createElement("img",{className:"",style:{maxWidth:"40px"},src:e.imagePath}),e.name),s.a.createElement("th",null,Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.price)),s.a.createElement("th",null,Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.priceBs)),s.a.createElement("th",null,e.quantity),s.a.createElement("th",null,e.totalFormattedDollars),s.a.createElement("th",null,e.totalFormattedBs),s.a.createElement("th",null,s.a.createElement("button",{onClick:this.clickHandler,className:"btn btn-danger p-0"},"Delete"))))),s.a.createElement("tfoot",null))))))}}var W=_;a(44),a(39);r.Component;class Q extends r.Component{componentDidMount(){}render(){return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Inventario"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement(A,{asyncTable:!0,sourceURL:"/api/inventory",columns:[{title:"Product ID",data:"id"},{title:"Nombre Producto",data:"name"},{title:"Inventario",data:"stock",render:function(e,t,a){return e<=0?`<span class="text-danger">${e}</span>`:`<span class="text-success">${e}</span>`}},{title:"Total productos vendidos",data:"salesTotal"},{title:"Total productos comprados",data:"supplyingsTotal"}],actions:[]}))))}}var K=Q;const Z=a(15),X=a(1);a(5);class ee extends r.Component{constructor(){super(),this.state={resource:"sales",parameters:""},this.submitHandler=this.submitHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.reportForm=s.a.createRef(),this.resourceTable=s.a.createRef()}changeHandler(e){let t=document.body.querySelector("#rangeDateFrom").value,a=document.body.querySelector("#rangeDateTo").value,r=document.body.querySelector("#greaterThanDate").value,s=document.body.querySelector("#lowerThanDate").value,n=document.body.querySelector("#equalDate").value;var l=this.state.parameters,o="";if("dateRadios"==e.target.name){switch(X("form").find("input[type=date]").val(""),e.target.id){case"today":o=`from=${Z(new Date).format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`;break;case"yesterday":o=`from=${Z(new Date).subtract(1,"days").format("YYYY-MM-DD")}&to=${Z(new Date).subtract(1,"days").format("YYYY-MM-DD")}`;break;case"lastWeek":o=`from=${Z(new Date).subtract(7,"days").format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`;break;case"fortnight":o=`from=${Z(new Date).subtract(15,"days").format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`;break;case"month":o=`from=${Z(new Date).subtract(1,"months").format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`;break;case"quarter":o=`from=${Z(new Date).subtract(3,"months").format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`;break;case"semester":o=`from=${Z(new Date).subtract(6,"months").format("YYYY-MM-DD")}&to=${Z(new Date).format("YYYY-MM-DD")}`}o+="&group=true"}else{if("reportType"==e.target.name)return void this.setState({resource:e.target.id,parameters:""},(function(){this.setState({parameters:l})}));switch(X("form").find("input[name=dateRadios]").prop("checked",!1),X("form").find("input[type=date]").val(""),e.target.id){case"greaterThanDate":o=`createdAt=${r}&operation=gte`,e.target.value=r;break;case"lowerThanDate":o=`createdAt=${s}&operation=lte`,e.target.value=s;break;case"equalDate":o=`createdAt=${n}&operation=eq`,e.target.value=n;break;case"rangeDateFrom":o=a?`from=${Z(t||"").format("YYYY-MM-DD")}&to=${a}`:"from="+Z(t||"").format("YYYY-MM-DD"),e.target.value=t,X("#rangeDateTo").val(a);break;case"rangeDateTo":o=t?`from=${t}&to=${Z(a||"").format("YYYY-MM-DD")}`:"to="+Z(a||"").format("YYYY-MM-DD"),e.target.value=a,X("#rangeDateFrom").val(t)}o+="&group=true"}this.setState({parameters:o})}componentDidUpdate(){this.resourceTable.current&&this.resourceTable.current.changeSourceURL(`/api/${this.state.resource}?${this.state.parameters}`)}submitHandler(e){e.preventDefault(),this.reportForm.current.reset()}render(){var e=[{title:"Product ID",data:"product.id"},{title:"Nombre",data:"product.name"},{title:"Cantidad de productos",data:"salesTotal"},{render:function(e,t,a,r){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.grossTotalDollars)},title:"sales"==this.state.resource?"Ganancia bruta $":"Costo bruto $",data:"grossTotalDollars"},{render:function(e,t,a,r){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.grossTotalBs)},title:"sales"==this.state.resource?"Ganancia bruta Bs":"Costo bruto Bs",data:"grossTotalBs"},{render:function(e,t,a,r){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.netIncomeDollars)},title:"sales"==this.state.resource?"Ganancia Neta $":"Ganancia neta $",data:"netIncomeDollars"},{render:function(e,t,a,r){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.netIncomeBs)},title:(this.state.resource,"Ganancia Neta Bs"),data:"netIncomeBs"}],t=[{title:"Product ID",data:"product.id"},{title:"Nombre",data:"product.name"},{title:"Cantidad de productos",data:"quantity"},{render:function(e,t,a,r){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.grossTotalDollars)},title:"sales"==this.state.resource?"Ganancia bruta $":"Costo bruto $",data:"grossTotalDollars"},{render:function(e,t,a,r){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.grossTotalBs)},title:"sales"==this.state.resource?"Ganancia bruta Bs":"Costo bruto Bs",data:"grossTotalBs"}];return s.a.createElement("div",{className:""},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Reportes"))),s.a.createElement("hr",null),s.a.createElement("form",{ref:this.reportForm,onSubmit:this.submitHandler},s.a.createElement("div",{className:"col-12"},s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("h3",{className:"mr-4"},"Tipo de reporte:")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"reportType",id:"supplyings",value:"supplyingRadio"}),s.a.createElement("label",{className:"form-check-label",htmlFor:"supplyingRadio"},"Compra")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"reportType",id:"sales",value:"saleRadio",defaultChecked:!0}),s.a.createElement("label",{className:"form-check-label",htmlFor:"saleRadio"},"Venta"))),s.a.createElement("hr",{className:"col-12 p-0"}),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-lg-2"},s.a.createElement("h5",{className:"mr-4"},"Rango de fechas:"),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"rangeDateFrom",id:"rangeDateFrom"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"rangeDateTo",id:"rangeDateTo"}))),s.a.createElement("div",{className:"col-12 col-lg-4"},s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"semester",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"semester"}),"6 meses")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"quarter",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"quarter"}),"3 meses")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"month",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"month"}),"1 mes")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"fortnight",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"fortnight"}),"15 d\xedas")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"lastWeek",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"lastWeek"}),"\xdatima semana")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"yesterday",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"yesterday"}),"Ayer")),s.a.createElement("div",{className:"form-check form-check-inline"},s.a.createElement("label",{className:"btn btn-secondary",htmlFor:"today",name:"labelDateRadios"},s.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"today"}),"Hoy"))),s.a.createElement("div",{className:"col-12 col-lg-2"},s.a.createElement("div",{className:""},s.a.createElement("h5",{className:""},"Fecha mayor o igual a:"),s.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"greaterThanDate",id:"greaterThanDate"}))),s.a.createElement("div",{className:"col-12 col-lg-2"},s.a.createElement("div",{className:""},s.a.createElement("h5",{className:""},"Fecha menor o igual a:"),s.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"lowerThanDate",id:"lowerThanDate"}))),s.a.createElement("div",{className:"col-12 col-lg-2"},s.a.createElement("div",{className:""},s.a.createElement("h5",{className:""},"Fecha igual a:"),s.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"equalDate",id:"equalDate"})))),s.a.createElement("hr",null)),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},""!=this.state.parameters&&s.a.createElement(A,{ref:this.resourceTable,asyncTable:!0,sourceURL:`/api/${this.state.resource}?${this.state.parameters}`,columns:"sales"==this.state.resource?e:t,actions:[],dolarReference:this.props.dolarReference}))))}}var te=ee;var ae={fetchAll:async function(){let e=await fetch("/api/debts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await e.json()},fetchById:async function(e){let t=await fetch("/api/debts?id="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},fetchByName:async function(e){let t=await fetch("/api/debts?name="+e,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});return await t.json()},create:async function(e){let t=await fetch("/api/debts",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},update:async function(e){let t=await fetch("/api/debts/"+e.id,{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}};a(5);class re extends r.Component{constructor(){super(),this.state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,debtType:0,debtTotal:null,debtAction:null,selectedRowData:null,selectedClient:null},this.submitHandler=this.submitHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.debtTable=s.a.createRef(),this.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#debtModal"},action:(e,t,a,r)=>{D()(".modal-title").text("Add new debt"),D()("#debtTotal").val(""),this.setState({debtAction:"Add",selectedClient:null})}},this.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#debtModal"},action:(e,t,a,r)=>{let s=t.row({selected:!0}).data();D()(".modal-title").text("Edit debt"),D()("#debtTotal").val(s.total),this.setState({debtAction:"Edit",selectedRowData:s,selectedClient:{label:s.client.name,value:s.client},debtType:s.type,debtTotal:s.total})}}}async componentDidMount(){let e=await ae.fetchAll();e.data?D()(this.debtTable.current).DataTable({data:e.data,columns:[{title:"ID",data:"id"},{title:"Client ID",data:"client.id"},{title:"Nombre",data:"client.name"},{title:"C\xe9dula",data:"client.cedula"},{title:"Tel\xe9fono",data:"client.phoneNumber"},{render:function(e){return 0==e?"Deuda":"Credito"},title:"Tipo",data:"type"},{render:function(e){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e)},title:"Total",data:"total"},{render:function(e){return 0==e?'<span class="text-danger">SIN PAGAR</span>':'<span class="text-success">PAGADO</span>'},title:"Estado",data:"cancelled"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single",order:[0,"DESC"]}):this.setState({fetchMessage:e.toString()})}changeHandler(e){this.setState({[e.target.name]:e.target.value})}optionChangeHandler(e,t){this.setState({selectedClient:e})}submitHandler(e){e.preventDefault();var t=null;this.setState({submitLoading:!0},async()=>{if("Add"==this.state.debtAction)t=await ae.create({clientId:this.state.selectedRowData.client.id,type:this.state.debtType,total:this.state.debtTotal});else if("Edit"==this.state.debtAction){t=await ae.update({id:this.state.selectedRowData.id,clientId:this.state.selectedRowData.clientId,type:this.state.debtType,total:this.state.debtTotal,cancelled:this.state.selectedRowData.cancelled}),D()(this.debtTable.current).DataTable().rows().data().map((e,t)=>{if(e.id==this.state.selectedRowData.id){let e=D()(this.debtTable.current).DataTable().row(t),a=e.data();e.data({...a,type:this.state.debtType,total:this.state.debtTotal})}})}t.error?this.setState({submitMessage:t.error,submitMessageType:"Error",submitLoading:!1}):(this.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout(()=>{this.setState({submitMessage:null,submitMessageType:null})},3e3))})}render(){return s.a.createElement("div",null,this.state.fetchMessage&&s.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{className:"text-danger float-left"},"Deuda"))),s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("table",{ref:this.debtTable,id:"debtTable",name:"debtTable",className:"table table-bordered"}))),s.a.createElement("div",{className:"modal fade",id:"debtModal",tabindex:"-1","aria-labelledby":"debtModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"debtModalLabel"},"Add new debt"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("form",{onSubmit:this.submitHandler},s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Client: "),s.a.createElement(B,{sourceURL:"/api/clients",value:this.state.selectedClient,changeHandler:this.optionChangeHandler})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Type: "),s.a.createElement("select",{onChange:this.changeHandler,className:"form-control",name:"debtType",id:"debtType"},s.a.createElement("option",{value:"0"},"DEUDA"),s.a.createElement("option",{value:"1"},"CREDITO"))),s.a.createElement("label",{htmlFor:"debtTotal"},"Total: "),s.a.createElement("div",{className:"input-group"},s.a.createElement("div",{class:"input-group-prepend"},s.a.createElement("div",{class:"input-group-text"},"Bs")),s.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.01",name:"debtTotal",id:"debtTotal"}))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&s.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&s.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}var se=re;class ne extends s.a.Component{constructor(){super(),this.state={loading:!0,isAuthenticated:!1}}componentDidMount(){E().then(e=>{this.setState({loading:!1,isAuthenticated:e})})}render(){const{component:e,...t}=this.props;return s.a.createElement(c.b,{render:a=>this.state.isAuthenticated?s.a.createElement(e,Object.assign({},a,t)):this.state.loading?s.a.createElement("div",null,"LOADING"):s.a.createElement(c.a,{to:{pathname:"/signin",state:{from:this.props.location}}})})}}var le=ne;class oe extends r.Component{constructor(){super(),this.state={formattedDolareReference:"",dolarReference:0,loading:!1,newDolarReference:null},this.fetchDolarReference=this.fetchDolarReference.bind(this),this.dolarReferenceSubmitHandler=this.dolarReferenceSubmitHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.closeEditDolarModalButton=s.a.createRef()}componentDidMount(){this.fetchDolarReference()}fetchDolarReference(){this.setState({loading:!0}),fetch("/api/dolarReference",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then(e=>e.json()).then(e=>{e.data?this.setState({dolarReference:e.data.price,formattedDolareReference:Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.data.price),loading:!1}):this.setState({dolarReference:0,formattedDolareReference:Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(0),loading:!1})})}changeHandler(e){this.setState({[e.target.name]:e.target.value})}dolarReferenceSubmitHandler(e){e.preventDefault(),fetch("/api/dolarReference",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({price:this.state.newDolarReference})}).then(e=>{204==e.status?window.location.reload():alert("Error")})}render(){return s.a.createElement("div",{className:"container-fluid"},s.a.createElement("div",{className:"row sticky-top"},s.a.createElement("div",{className:"col-md-12 p-0"},s.a.createElement(J,null))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"bg-danger text-light col-12"},"Precio del Dolar ",s.a.createElement("span",{id:"dolarReference",className:"badge badge-light"},this.state.loading?"Loading...":this.state.formattedDolareReference),s.a.createElement("button",{className:"btn btn-secondary ml-4","data-toggle":"modal","data-target":"#dolarEditModal"},"Editar"))),s.a.createElement("main",{className:"mt-5"},s.a.createElement(c.b,{path:"/control-de-ventas",render:e=>s.a.createElement(W,Object.assign({},e,{dolarReference:this.state.dolarReference}))}),s.a.createElement(c.b,{path:"/inventario",component:K}),s.a.createElement(c.b,{path:"/reportes",render:e=>s.a.createElement(te,Object.assign({},e,{dolarReference:this.state.dolarReference}))}),s.a.createElement(c.b,{path:"/deuda",render:e=>s.a.createElement(se,Object.assign({},e,{dolarReference:this.state.dolarReference}))}),s.a.createElement(c.b,{path:"/categorias",component:w}),s.a.createElement(c.b,{path:"/clientes",component:H}),s.a.createElement(c.b,{path:"/productos",render:e=>s.a.createElement(j,Object.assign({},e,{dolarReference:this.state.dolarReference}))}),s.a.createElement(c.b,{path:"/ventas",component:$}),s.a.createElement(c.b,{path:"/abastecimiento",render:e=>s.a.createElement(U,Object.assign({},e,{dolarReference:this.state.dolarReference}))}),s.a.createElement(c.b,{path:"/proveedores",component:Y}),s.a.createElement(c.b,{path:"/usuarios",component:z})),s.a.createElement("div",{className:"modal fade",id:"dolarEditModal",tabindex:"-1","aria-labelledby":"dolarEditModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"dolarEditModalLabel"},"Nuevo precio del dolar"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("form",{onSubmit:this.dolarReferenceSubmitHandler},s.a.createElement("div",{className:"modal-body"},s.a.createElement("input",{name:"newDolarReference",onChange:this.changeHandler,className:"form-control",type:"number",placeholder:"Ingrese el nuevo precio del dolar. Ej: 400000"})),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{ref:this.closeEditDolarModalButton,type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save changes")))))))}}var ce=oe,ie=a(18);const de={data:[],next:{},previous:{},loading:!1};const me={activeCategoryId:0,activeCategoryName:"",data:[]};var ue={products:function(e=de,t){switch(t.type){case"LOAD_PRODUCTS":return{...e,data:t.paginatedProducts.data,next:t.paginatedProducts.next,previous:t.paginatedProducts.previous};case"LOADING":return{...e,loading:t.loading};default:return e}},categories:function(e=me,t){switch(t.type){case"LOAD_CATEGORIES":return{...e,data:t.categories};case"SET_ACTIVE_CATEGORY_ID":return{...e,activeCategoryId:t.categoryId};case"SET_ACTIVE_CATEGORY_NAME":return{...e,activeCategoryName:t.categoryName};default:return e}}};const he=Object(ie.b)({...ue});const pe=Object(ie.c)(he);var ge=function(){return s.a.createElement(i.a,{store:pe},s.a.createElement("div",{className:"App"},s.a.createElement(o.a,null,s.a.createElement(c.d,null,s.a.createElement(c.b,{exact:!0,path:"/signin",component:N}),s.a.createElement(le,{path:"/",component:ce})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(s.a.Fragment,null,s.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}},[[45,1,2]]]);
//# sourceMappingURL=main.7fbbd6b5.chunk.js.map