(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),c=a.n(s),l=(a(62),a(63),a(64),a(12)),o=a(11),i=a(4),d=a(5),m=a(1),u=a(7),p=a(6),h=a(50),b=a.n(h),f=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return this.props.noResults?r.a.createElement("ul",{className:"list-group position-absolute w-100"},r.a.createElement("li",{className:"list-group-item text-justify"},"No se encontraron resultados")):r.a.createElement("ul",{className:"list-group position-absolute w-100 suggestionsBox"},this.props.suggestions.map((function(t){return e.props.onlyName?r.a.createElement("div",{onClick:e.props.clickHandler,key:t.id,productid:t.id,className:"text-justify"},r.a.createElement("li",{className:"list-group-item"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-1"},r.a.createElement("img",{style:{maxWidth:"35px"},src:t.imagePath,alt:"IMG"})),r.a.createElement("div",{className:"col-6 float-left"},r.a.createElement("h5",{className:"font-weight-bold",id:"productName"},t.name))))):r.a.createElement("li",{onClick:e.props.clickHandler,key:t.id,className:"list-group-item text-justify"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-sm-6 col-md-12 col-lg-12 col-xl-6"},r.a.createElement("img",{className:"",style:{maxWidth:"35px"},src:t.imagePath,alt:"IMG"}),r.a.createElement("span",{id:"productName font-weight-bold"},t.name)),r.a.createElement("div",{className:"col-6 col-sm-4 col-md-6 col-lg-6 col-xl-4"},r.a.createElement("div",{className:"input-group "},r.a.createElement("input",{className:"form-control text-center",style:{minWidth:"45px",maxWidth:"70px"},type:"number",defaultValue:"1",name:"numberOfItems",id:"numberOfItems"}),r.a.createElement("input",{className:"bg-dark text-light",type:"button",value:"Comprar"}))),r.a.createElement("div",{className:"col-6 col-sm-2 col-md-6 col-lg-6 col-xl-2 "},r.a.createElement("span",{className:"text-danger"},"".concat(t.price," Bs.")))))})))}}]),a}(n.Component),g=a(36),E=a.n(g),v=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={showSuggestions:!1,suggestions:[],noResults:!1},e.searchHandler=E()(e.searchHandler,500),e.headerContainer=r.a.createRef(),e.onBlurHandler=e.onBlurHandler.bind(Object(m.a)(e)),e}return Object(d.a)(a,[{key:"searchHandler",value:function(e){var t=this;e.target.value.length>0?fetch("/api/products?name=".concat(e.target.value,"&page=1&limit=10")).then((function(e){return e.json()})).then((function(e){e.data.length>0?t.setState({showSuggestions:!0,suggestions:e.data,noResults:!1}):t.setState({showSuggestions:!0,noResults:!0})})):this.setState({showSuggestions:!1,suggestions:[]})}},{key:"onBlurHandler",value:function(){this.setState({showSuggestions:!1})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.parentClassName},r.a.createElement("input",{onChange:function(t){t.persist(),e.searchHandler(t)},className:this.props.className,type:"text",placeholder:"Buscar Producto",id:"searchInput"}),r.a.createElement("div",{ref:this.suggestionBox,className:""},this.state.showSuggestions&&r.a.createElement(b.a,{onOutsideClick:this.onBlurHandler},r.a.createElement(f,{suggestions:this.state.suggestions,noResults:this.state.noResults,clickHandler:this.props.clickHandler,onlyName:this.props.onlyName}))))}}]),a}(n.Component),y=(n.Component,n.Component,a(23)),N=a(24),S=a(26),D=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).fetchProducts=e.fetchProducts.bind(Object(m.a)(e)),e.categoryHandler=e.categoryHandler.bind(Object(m.a)(e)),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("/api/categories").then((function(e){return e.json()})).then((function(t){t.data.length>0&&(e.props.dispatch(S.loadCategories(t.data)),e.props.dispatch(S.setActiveCategoryId(document.querySelector(".categoryItem, active").getAttribute("categoryId"))),e.props.dispatch(S.setActiveCategoryName(document.querySelector(".categoryItem, active").innerText)))}))}},{key:"categoryHandler",value:function(e){e.preventDefault(),e.target.className.includes("active")||(e.target.parentElement.querySelector(".active").classList.remove("active"),e.target.classList.add("active"),this.props.dispatch(S.setActiveCategoryId(e.target.getAttribute("categoryid"))),this.props.dispatch(S.setActiveCategoryName(e.target.innerText)),this.fetchProducts(1,16,e.target.getAttribute("categoryid")))}},{key:"fetchProducts",value:function(e,t,a){var n=this;this.props.dispatch(N.setLoading(!0)),fetch("/api/products?page=".concat(e,"&limit=").concat(t,"&categories=").concat(a)).then((function(e){return e.json()})).then((function(e){n.props.dispatch(N.loadProducts(e)),n.props.dispatch(N.setLoading(!1))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"col-xs-6 col-sm-12 col-md-12 p-0 mt-0 mt-md-5 productcategoriesContainer"},r.a.createElement("div",{className:"card rounded-0"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"card-title text-danger font-weight-bold"},"Categorias")),r.a.createElement("div",{className:"card-body p-0"},r.a.createElement("div",{className:"list-group"},this.props.categories?this.props.categories.map((function(t,a){return 0===a?r.a.createElement("li",{onClick:e.categoryHandler,categoryid:t.id,key:t.id,className:"categoryItem list-group-item active btn"},t.name):r.a.createElement("li",{onClick:e.categoryHandler,categoryid:t.id,key:t.id,className:"categoryItem list-group-item btn"},t.name)})):r.a.createElement("span",null,"No hay categorias")))))}}]),a}(n.Component);Object(y.b)((function(e,t){return{categories:e.categories.data,activeCategory:e.categories.activeCategory}}))(D);var C=a(52),x=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("h3",{className:"float-left text-danger mt-2"},this.props.activeCategory)}}]),a}(n.Component);var w=Object(y.b)((function(e,t){return{activeCategory:e.categories.activeCategoryName}}))(x),j=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).observer=new IntersectionObserver(e.loadMoreProductsHandler.bind(Object(m.a)(e))),e.elementToObserve=r.a.createRef(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchProducts(1,16)}},{key:"componentDidUpdate",value:function(){this.elementToObserve.current&&this.observer.observe(this.elementToObserve.current)}},{key:"fetchProducts",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.props.dispatch(N.setLoading(!0)),fetch("/api/products?page=".concat(e,"&limit=").concat(t,"&categories=").concat(n)).then((function(e){return e.json()})).then((function(e){e.data=a.props.products.concat(e.data),a.props.dispatch(N.loadProducts(e)),a.props.dispatch(N.setLoading(!1))}))}},{key:"loadMoreProductsHandler",value:function(e){e[0].isIntersecting&&this.props.next&&this.fetchProducts(this.props.next.page,this.props.next.limit,this.props.activeCategory)}},{key:"render",value:function(){if(this.props.products.length>0){var e=this.props.products.map((function(e,t){return r.a.createElement("div",{className:"col-6 col-sm-6 col-md-4 col-lg-3 p-0 pr-2 pb-2",key:t},r.a.createElement("div",{className:"card"},r.a.createElement("img",{className:"card-img-top productImage",src:e.imagePath,alt:"Imagen del producto"}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title font-weight-bold overflow-hidden text-truncate text-dark"},e.name),r.a.createElement("h5",{className:"text-danger"},"Bs. ",e.price)),r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"input-group d-flex justify-content-center"},r.a.createElement("input",{className:"form-control text-center",style:{maxWidth:"35%"},type:"number",defaultValue:"1",name:"numberOfItems",id:"numberOfItems"}),r.a.createElement("input",{className:"bg-dark text-light",type:"button",value:"Comprar"})))))}));return this.props.next&&e.push(r.a.createElement("div",{className:"col-xs-12 col-sm-6 col-md-4 col-lg-3 p-0 pr-2 pb-2",key:"contentLoader",ref:this.elementToObserve},r.a.createElement(C.a,{speed:1,viewBox:"0 0 200 400",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb"},r.a.createElement("rect",{x:"0",y:"6",rx:"0",ry:"0",width:"239",height:"250"}),r.a.createElement("rect",{x:"0",y:"292",rx:"0",ry:"0",width:"239",height:"15"}),r.a.createElement("rect",{x:"59",y:"291",rx:"0",ry:"0",width:"2",height:"0"}),r.a.createElement("rect",{x:"0",y:"313",rx:"0",ry:"0",width:"239",height:"15"}),r.a.createElement("rect",{x:"0",y:"361",rx:"0",ry:"0",width:"239",height:"36"})))),e.unshift(r.a.createElement("div",{className:"col-12"},r.a.createElement(w,null))),e}return this.props.loading?r.a.createElement("p",null,"Loading"):r.a.createElement("p",null,"No hay productos")}}]),a}(n.Component);Object(y.b)((function(e,t){return{products:e.products.data,next:e.products.next,previous:e.products.previous,loading:e.products.loading,activeCategory:e.categories.activeCategory}}))(j),n.Component;var k=a(2),T=a.n(k),O=a(8);function H(){return(H=Object(O.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("jwt")){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",fetch("/sessions/isAuthenticated?token=".concat(t)).then((function(e){return e.json()})).then((function(e){return e.auth})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=function(){return H.apply(this,arguments)};class I extends n.Component{constructor(){super(),this.onSubmitHandler=this.onSubmitHandler.bind(this),this.inputHandler=this.inputHandler.bind(this),this.state={email:null,password:null,logginError:null}}componentDidMount(){R().then(e=>{e&&this.props.history.push("/")})}onSubmitHandler(e){e.preventDefault(),this.setState({logginError:null}),fetch("/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password})}).then(e=>e.json()).then(e=>{e.err?this.setState({logginError:e.err}):(localStorage.setItem("jwt",e.token),this.props.history.push("/"))})}inputHandler(e){this.setState({[e.target.name]:e.target.value})}render(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row h-100"},r.a.createElement("div",{className:"col-10 col-md-5 my-auto mx-auto"},r.a.createElement("form",{onSubmit:this.onSubmitHandler,className:"col-12",action:"/sessions",method:"POST"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{onChange:this.inputHandler,type:"text",className:"form-control",name:"email",id:"email",placeholder:"Email"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{onChange:this.inputHandler,type:"password",className:"form-control",name:"password",id:"password",placeholder:"Password"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Enviar")),r.a.createElement("div",{className:"form-group"},r.a.createElement("p",{className:"text-danger"},this.state.logginError))))))}}var M=I,A=a(13),B=a(10),P="/api/categories",F={fetchAll:function(){var e=Object(O.a)(T.a.mark((function e(){var t,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fetchById:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"?id=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchByName:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"?name=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P,{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"/".concat(t.id),{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify()});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=a(3),Y=a.n(L);a(14);var q=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,categoryName:null,categoryAction:null,selectedRowData:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.changeHandler=e.changeHandler.bind(Object(m.a)(e)),e.categoriesTable=r.a.createRef(),e.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#categoryModal"},action:function(t,a,n,r){Y()(".modal-title").text("Add new category"),Y()("#categoryName").val(""),e.setState({categoryAction:"Add"})}},e.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#categoryModal"},action:function(t,a,n,r){var s=a.row({selected:!0}).data();Y()(".modal-title").text("Edit category"),Y()("#categoryName").val(s.name),e.setState({categoryAction:"Edit",selectedRowData:s})}},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.fetchAll();case 2:(t=e.sent).data?Y()(this.categoriesTable.current).DataTable({data:t.data,columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"Fecha creaci\xf3n",data:"createdAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single"}):this.setState({fetchMessage:t.toString()});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault();var a=null;this.setState({submitLoading:!0},Object(O.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Add"!=t.state.categoryAction){e.next=6;break}return e.next=3,F.create({name:t.state.categoryName});case 3:a=e.sent,e.next=12;break;case 6:if("Edit"!=t.state.categoryAction){e.next=12;break}return e.next=9,F.edit({id:t.state.selectedRowData.id,name:t.state.categoryName});case 9:a=e.sent,Y()(t.categoriesTable.current).DataTable().rows().data().map((function(e,a){if(e.id==t.state.selectedRowData.id){var n=Y()(t.categoriesTable.current).DataTable().row(a),r=n.data();n.data(Object(B.a)(Object(B.a)({},r),{},{name:t.state.categoryName}))}}));case 12:a.error?t.setState({submitMessage:a.error,submitMessageType:"Error",submitLoading:!1}):(t.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout((function(){t.setState({submitMessage:null,submitMessageType:null})}),3e3));case 13:case"end":return e.stop()}}),e)}))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.fetchMessage&&r.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Categor\xedas"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{ref:this.categoriesTable,id:"categoriesTable",name:"categoriesTable",className:"table table-bordered"}))),r.a.createElement("div",{className:"modal fade",id:"categoryModal",tabindex:"-1","aria-labelledby":"categoryModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"categoryModalLabel"},"Add new category"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{onSubmit:this.submitHandler},r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Category Name: "),r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"text",name:"categoryName",id:"categoryName",required:!0}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&r.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&r.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}]),a}(n.Component),U={fetchAll:function(){var e=Object(O.a)(T.a.mark((function e(){var t,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/clients",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fetchById:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/clients"+"?id=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchByName:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/clients"+"?name=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/clients",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/clients"+"/".concat(t.id),{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};a(14);var V=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,name:null,cedula:null,phoneNumber:null,selectedRowData:null,clientAction:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.changeHandler=e.changeHandler.bind(Object(m.a)(e)),e.optionChangeHandler=e.optionChangeHandler.bind(Object(m.a)(e)),e.clientTable=r.a.createRef(),e.customSelectRef=r.a.createRef(),e.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#clientModal"},action:function(t,a,n,r){Y()(".modal-title").text("Add new client"),Y()("#name").val(""),Y()("#cedula").val(""),Y()("#phoneNumber").val(""),e.setState({clientAction:"Add"})}},e.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#clientModal"},action:function(t,a,n,r){var s=a.row({selected:!0}).data();Y()(".modal-title").text("Edit client"),Y()("#name").val(s.name),Y()("#cedula").val(s.cedula),Y()("#phoneNumber").val(s.phoneNumber),e.setState({clientAction:"Edit",selectedRowData:s,name:s.name,cedula:s.cedula,phoneNumber:s.phoneNumber})}},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.fetchAll();case 2:(t=e.sent).data?(console.log(t.data),Y()(this.clientTable.current).DataTable({data:t.data,columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"C\xe9dula",data:"cedula"},{title:"Tel\xe9fono",data:"phoneNumber"},{title:"Fecha creaci\xf3n",data:"createdAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single",order:[0,"DESC"]})):this.setState({fetchMessage:t.toString()});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"optionChangeHandler",value:function(e,t){this.setState({selectedClient:e})}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault();var a=null;this.setState({submitLoading:!0},Object(O.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Add"!=t.state.clientAction){e.next=6;break}return e.next=3,U.create({name:t.state.name,cedula:t.state.cedula,phoneNumber:t.state.phoneNumber});case 3:a=e.sent,e.next=13;break;case 6:if("Edit"!=t.state.clientAction){e.next=13;break}return console.log(t.state),e.next=10,U.update({id:t.state.selectedRowData.id,name:t.state.name,cedula:t.state.cedula,phoneNumber:t.state.phoneNumber});case 10:a=e.sent,Y()(t.clientTable.current).DataTable().rows().data().map((function(e,a){if(e.id==t.state.selectedRowData.id){var n=Y()(t.clientTable.current).DataTable().row(a),r=n.data();n.data(Object(B.a)(Object(B.a)({},r),{},{name:t.state.name,cedula:t.state.cedula,phoneNumber:t.state.phoneNumber}))}}));case 13:a&&a.error?t.setState({submitMessage:JSON.stringify(a.error),submitMessageType:"Error",submitLoading:!1}):(t.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout((function(){t.setState({submitMessage:null,submitMessageType:null})}),3e3));case 14:case"end":return e.stop()}}),e)}))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.fetchMessage&&r.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Clientes"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{ref:this.clientTable,id:"clientTable",name:"clientTable",className:"table table-bordered"}))),r.a.createElement("div",{className:"modal fade",id:"clientModal",tabindex:"-1","aria-labelledby":"clientModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"clientModalLabel"},"Add new client"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{onSubmit:this.submitHandler},r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Nombre: "),r.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"name",id:"name",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"C\xe9dula: "),r.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"cedula",id:"cedula",required:!0})),r.a.createElement("label",{htmlFor:"debtTotal"},"Tel\xe9fono: "),r.a.createElement("input",{onChange:this.changeHandler,type:"text",className:"form-control",name:"phoneNumber",id:"phoneNumber"})),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&r.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&r.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}]),a}(n.Component),z=a(3),G=(a(14),a(88));a(93),a(94),a(95),a(96),a(97),a(98),window.JSZip=G;var J=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this)).recordsTable=r.a.createRef(),n.modal=r.a.createRef(),n.state={selectedRowData:null,sourceURL:e.sourceURL},n}return Object(d.a)(a,[{key:"changeSourceURL",value:function(e){var t=this.recordsTable.current;z(t).DataTable().ajax.url(e).load()}},{key:"componentDidMount",value:function(){var e=this,t=this.recordsTable.current,a=z(t),n=this;this.props.asyncTable?(a=a.DataTable({initComplete:function(){this.api().columns().every((function(){var e=this;"createdAt"==e.dataSrc()||"updatedAt"==e.dataSrc()?z(this.header()).append("<br><input class='p-0 m-0 h-100' type='date' />"):z(this.header()).append("<br><input class='p-0 m-0 h-100' type='text' placeholder='Filtrar'/>"),z("input",this.header()).on("keyup change",(function(){var t=e.dataSrc().split("."),r="";t.forEach((function(e,a){0==a?r=t[0]:r+=t[a].charAt(0).toUpperCase()+t[a].slice(1)})),n.props.sourceURL.includes("?")?a.ajax.url("".concat(n.props.sourceURL,"&").concat(r,"=").concat(this.value.trim())).load():a.ajax.url("".concat(n.props.sourceURL,"?").concat(r,"=").concat(this.value.trim())).load()}))}))},footerCallback:function(e,t){var a=this.api();a.columns().every((function(){if("grossTotalDollars"==this.dataSrc()){var e=a.column(3).data().reduce((function(e,t){return e+t}),0),t=a.column(3,{page:"current"}).data().reduce((function(e,t){return e+t}),0);e?z(this.footer()).html("".concat(Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),' <br>\n                                            <span class="text-danger">(').concat(Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)," Total)</span>")):z(this.footer()).html("")}if("grossTotalBs"==this.dataSrc()){var n=a.column(4).data().reduce((function(e,t){return e+t}),0),r=a.column(4,{page:"current"}).data().reduce((function(e,t){return e+t}),0);r?z(this.footer()).html("".concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(r),' <br>\n                                        <span class="text-danger">(').concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(n)," Total)</span>")):z(this.footer()).html("")}if("netIncomeDollars"==this.dataSrc()){var s=a.column(5).data().reduce((function(e,t){return e+t}),0),c=a.column(5,{page:"current"}).data().reduce((function(e,t){return e+t}),0);c?z(this.footer()).html("".concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(c),' <br>\n                                        <span class="text-danger">(').concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(s)," Total)</span>")):z(this.footer()).html("")}if("netIncomeBs"==this.dataSrc()){var l=a.column(6).data().reduce((function(e,t){return e+t}),0),o=a.column(6,{page:"current"}).data().reduce((function(e,t){return e+t}),0);o?z(this.footer()).html("".concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(o),' <br>\n                                        <span class="text-danger">(').concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(l)," Total)</span>")):z(this.footer()).html("")}}))},dom:"Brltip",select:"single",buttons:[{text:"Imprimir",name:"imprimir",className:"btn btn-secondary float-right",extend:"print",messageTop:"Lista de precios",footer:!0,title:n.props.sourceURL.includes("productss")?"Lista de precios":"",customize:function(e){z(e.document.body).find("#messageTop").css("text-align","center")},exportOptions:{modifier:{page:"all"},columns:n.props.sourceURL.includes("products")?[1,2,3]:":visible"}}].concat(this.props.actions.map((function(e){return"add"==e?{text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#exampleModal"},action:function(){n.props.setModalAction("add")}}:"edit"==e?{text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#exampleModal"},action:function(e,t,a,r){var s=t.row({selected:!0}).data();n.props.setSelectedRowData(s),n.props.setModalAction("edit")}}:"delete"==e?{text:"Delete",name:"delete",className:"btn btn-danger",extend:"selected",action:function(e,t,a,r){var s=t.row({selected:!0}).data();1==window.confirm("\xbfEst\xe1 seguro que desea eliminar este registro?")&&fetch("".concat(n.props.sourceURL,"/").concat(s.id),{method:"DELETE",headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){204==e.status?t.ajax.reload():e.json().then((function(e){n.setState({error:e})}))})).catch((function(e){n.setState({error:e})}))}}:"date-range"==e?{text:"Reload",name:"reload",className:"btn btn-primary",action:function(e,t,a,r){t.ajax.url(n.state.sourceURL).load()}}:"discount"==e?[{text:"Apply Discount",name:"discountButton",className:"btn btn-primary",attr:{"data-toggle":"modal","data-target":"#discountModal"},extend:"selected",action:function(e,t,a,r){var s=t.row({selected:!0}).data();n.props.setSelectedRowData(s),n.props.setModalAction("applyDiscount")}},{text:"Cancel Discount",name:"cancelDiscountButton",className:"btn btn-danger",extend:"selected",action:function(e,t,a,n){if(1==window.confirm("\xbfSeguro que desea eliminar el descuento?")){var r=t.row({selected:!0}).data().discount[0].id;fetch("/api/discounts/".concat(r),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")},method:"DELETE"}).then((function(e){204==e.status&&t.ajax.reload()}))}}}]:void 0}))),serverSide:!0,ajax:{url:this.state.sourceURL,dataSrc:function(e){return"object"==typeof e.count&&e.data.forEach((function(t,a){t.productId==e.count[a].id&&(t.count=e.count[a].count)})),n.props.sourceURL.includes("/api/sales")&&n.props.sourceURL.includes("group=true")?e.data.forEach((function(e,t){e.product=e.product[0],e.grossTotalBs=e.grossTotalDollars*e.dolarReference,e.netIncomeDollars=e.grossTotalDollars*(e.product.profitPercent/100),e.netIncomeBs=e.netIncomeDollars*e.dolarReference})):n.props.sourceURL.includes("/api/supplyings")&&n.props.sourceURL.includes("group=true")&&e.data.forEach((function(e,t){e.grossTotalBs=e.grossTotalDollars*e.dolarReference})),e.data},headers:{Authorization:"Bearer ".concat(localStorage.getItem("jwt"))},data:function(e){-1!=e.length?(e.page=e.start/e.length+1,e.limit=e.length):(e.page=1,e.limit=0)},error:function(e,t,a){}},paging:!0,lengthMenu:[[10,25,50,100,1e15],[10,25,50,100,"All"]],pageLength:this.props.sourceURL.includes("group=true")?1e15:10,columns:this.props.columns,columnDefs:this.props.sourceURL.includes("products")?[{width:"30%",targets:1}]:null,ordering:!1,order:n.props.sorting||[[0,"desc"]]}),this.props.actions.includes("date-range")&&(z(".dt-buttons").append('<div class="d-flex justify-content-end">\n                    <label class="mr-2" for="dateFrom">From:</label>\n                    <input type="date" id="dateFrom" name="dateFrom">\n                    <label class="mr-2 ml-2" for="dateTo">To:</label>\n                    <input type="date" id="dateTo" name="dateTo">\n                    </div>'),z(".dt-buttons input[type=date]").on("change",(function(){a.ajax.url("".concat(n.state.sourceURL,"?from=").concat(z("#dateFrom").val(),"&to=").concat(z("#dateTo").val())).load()}))),z("#resourceTable tbody").on("click","td.details-control",(function(){var e=z(this).closest("tr"),t=a.row(e);t.child.isShown()?(t.child.hide(),e.removeClass("shown")):(t.child(n.props.childFormat(t.data())).show(),e.addClass("shown"))}))):a=a.DataTable({dom:"",data:this.props.data,columns:this.props.columns}),this.modal.current.addEventListener("focus",(function(){e.modal.current.querySelector(".form-group").children[0].focus()}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"bg-light table-responsive"},r.a.createElement("table",{id:"resourceTable",className:"table table-bordered",ref:this.recordsTable},r.a.createElement("thead",null),r.a.createElement("tbody",null),r.a.createElement("tfoot",null,r.a.createElement("tr",null,this.props.columns.map((function(e,t){return r.a.createElement("td",{key:t})}))))),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error),r.a.createElement("div",{ref:this.modal,className:"modal",id:"exampleModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},this.props.modalStructure))))}}]),a}(n.Component),$=a(21);a(25);a(14);class _ extends n.Component{constructor(){super(),this.state={selectedCategories:null,name:null,productImageFile:null,profitPercent:null,success:null,error:null,modalAction:null,discountPercent:null,discountStartDate:null,discountEndDate:null,selectedRowData:null},this.submitHandler=this.submitHandler.bind(this),this.discountSubmitHandler=this.discountSubmitHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.changeHandler=this.changeHandler.bind(this),this.setModalAction=this.setModalAction.bind(this),this.setSelectedRowData=this.setSelectedRowData.bind(this),this.CustomSelectRef=r.a.createRef(),this.productForm=r.a.createRef(),this.closeButton=r.a.createRef()}setModalAction(e){this.setState({modalAction:e})}setSelectedRowData(e){let t=[];e.category.forEach(e=>{t.push({id:e.id,label:e.name,value:e.name})}),this.setState({selectedRowData:e,selectedCategories:t,name:e.name,profitPercent:e.profitPercent},()=>{Y()("#name").val(this.state.selectedRowData.name),Y()("#profitPercent").val(this.state.selectedRowData.profitPercent)})}optionChangeHandler(e,t){this.setState({selectedCategories:e})}changeHandler(e){this.setState({[e.target.name]:"file"==e.target.type?e.target.files[0]:e.target.value})}submitHandler(e){e.preventDefault();var t="";this.state.selectedCategories?this.state.selectedCategories.forEach((e,a)=>{t+=e.id,a!=this.state.selectedCategories.length-1&&(t+=",")}):alert("Seleccione las categor\xedas");var a=new FormData;a.append("productImageFile",this.state.productImageFile),a.append("name",this.state.name),a.append("profitPercent",this.state.profitPercent),a.append("categories",t),fetch("add"==this.state.modalAction?"/api/products":"/api/products/"+this.state.selectedRowData.id,{method:"add"==this.state.modalAction?"POST":"PATCH",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),Accept:"application/json"},body:a}).then(e=>{200==e.status?(this.setState({success:"El producto se ha registrado con exito",productImageFile:null}),this.productForm.current.reset(),this.closeButton.current.click(),Y()("#resourceTable").DataTable().ajax.reload(null,!1)):409==e.status&&e.json().then(e=>{this.setState({error:e.error||e.err})})}).catch(e=>{this.setState({error:e})})}discountSubmitHandler(e){e.preventDefault(),this.state.discountPercent&&this.state.discountStartDate&&this.state.discountEndDate?fetch("/api/discounts",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({productId:this.state.selectedRowData.id,percent:this.state.discountPercent,startDate:this.state.discountStartDate,endDate:this.state.discountEndDate})}).then(e=>{200==e.status?this.setState({success:"Se ha registrado con \xe9xito"}):e.json().then(e=>{this.setState({error:e.error||e.err})})}):alert("Rellene todos los campos")}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}render(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Productos"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,setSelectedRowData:this.setSelectedRowData,setModalAction:this.setModalAction,sourceURL:"/api/products",columns:[{title:"ID",data:"id"},{render:function(e,t,a,n){return a.imagePath?`<span class="p-0"><img class="img-responsive m-0 p-0" src="${a.imagePath}" style="max-width:40px;"></img>${e}</span>`:e},title:"Nombre",data:"name"},{title:"Precio $",data:"price"},{render:e=>Intl.NumberFormat("es-Ve",{style:"currency",currency:"VES"}).format(this.roundToNiceNumber(e*this.props.dolarReference)),title:"Precio Bs",data:"price"},{render:function(e){return e+"%"},title:"Porcentaje de Ganancia",data:"profitPercent"},{render:function(e,t,a,n){let r=e.map(e=>e.percent);return r.length?r+"%":"0%"},title:"Descuento",data:"discount"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],actions:["add","edit","delete","discount"],modalStructure:r.a.createElement("form",{ref:this.productForm,onSubmit:this.submitHandler,className:"float-left"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Product"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Product Name: "),r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"text",name:"name",id:"name",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"profitPercent"},"Profit Percent: "),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("div",{className:"input-group-text"},"%")),r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.1",name:"profitPercent",id:"profitPercent",required:!0}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"productImageFile"},"Imagen: "),r.a.createElement("div",{className:"custom-file"},r.a.createElement("input",{onChange:this.changeHandler,type:"file",className:"custom-file-input",id:"productImageFile",name:"productImageFile"}),r.a.createElement("label",{className:"custom-file-label",htmlFor:"image"},"Choose file"))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"price"},"Categor\xedas: "),r.a.createElement($.a,{sourceURL:"/api/categories",isMulti:!0,innerRef:this.CustomSelectRef,changeHandler:this.optionChangeHandler,value:this.state.selectedCategories,required:!0}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{ref:this.closeButton,type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&r.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error))}),r.a.createElement("div",{id:"discountModal",className:"modal",tabIndex:"-1"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title"}),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{onSubmit:this.discountSubmitHandler},r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"discountPercent"},"Discount Percent: "),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.01",min:"0",name:"discountPercent",id:"discountPercent",required:!0}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("div",{className:"input-group-text"},"%"))),r.a.createElement("label",{htmlFor:"discountStartDate"},"Start Date:"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"date",name:"discountStartDate",id:"discountStartDate",required:!0})),r.a.createElement("label",{htmlFor:"discountEndDate"},"End Date:"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"date",name:"discountEndDate",id:"discountEndDate",required:!0})))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&r.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error))))))))}}var W=_,Q=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.roundToNiceNumber=e.roundToNiceNumber.bind(Object(m.a)(e)),e.childFormat=e.childFormat.bind(Object(m.a)(e)),e}return Object(d.a)(a,[{key:"submitHandler",value:function(e){e.preventDefault(),console.log("hola")}},{key:"roundToNiceNumber",value:function(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}},{key:"childFormat",value:function(e){var t=this,a="";return e.saleProducts.forEach((function(e){a+='\n            <div class=\'form-row align-items-center\'>\n                    <div class="col-1">\n                        <label for="productId">Product ID</label>\n                        <input class="form-control" id="productId" value="'.concat(e.productId,'" disabled/>\n                    </div>\n                    <div class="col-4">\n                        <label for="productName">Name</label>\n                        <input class="form-control" id="productName" value="').concat(e.product[0].name,'" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productPrice">Price $</label>\n                        <input class="form-control" id="productPrice" value="$').concat(e.price,'" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productPriceBs">Price Bs</label>\n                        <input class="form-control" id="productPriceBs" value="Bs.S ').concat(t.roundToNiceNumber(e.price*e.dolarReference),'" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="discount">Discount</label>\n                        <input class="form-control" id="discount" value="').concat(e.discount,'%" disabled/>\n                    </div>\n                    <div class="col-1">\n                        <label for="productQuantity">Quantity</label>\n                        <input class="form-control" id="productQuantity" value="').concat(e.quantity,'" disabled/>\n                    </div>\n                    <div class="col-2">\n                        <label for="dolarValue">Dolar value</label>\n                        <input class="form-control" id="dolarValue" value="').concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.dolarReference),'" disabled/>\n                    </div>\n            </div>\n            ')})),a+=""}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Ventas"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,childFormat:this.childFormat,sourceURL:"/api/sales",columns:[{title:"ID",data:"id"},{title:"Productos",className:"details-control",orderable:!1,data:"productName",defaultContent:'<button class="btn btn-success">Ver Productos</button>'},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["edit","delete"]}))))}}]),a}(n.Component),K=(a(14),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={name:null,rif:null,success:null,error:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.inputChangeHandler=e.inputChangeHandler.bind(Object(m.a)(e)),e.setModalAction=e.setModalAction.bind(Object(m.a)(e)),e}return Object(d.a)(a,[{key:"setModalAction",value:function(e){this.setState({modalAction:e})}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault(),this.state.name&&this.state.rif&&fetch("/api/suppliers",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({name:this.state.name,rif:this.state.rif})}).then((function(e){200==e.status?(t.setState({success:"Se ha registrado de forma exitosa."}),Y()("#resourceTable").DataTable().draw()):e.text().then((function(e){t.setState({error:e})}))}))}},{key:"inputChangeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Proveedores"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,setModalAction:this.setModalAction,sourceURL:"/api/suppliers",columns:[{title:"ID",data:"id"},{title:"Nombre",data:"name"},{title:"RIF",data:"rif"},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["add","edit","delete"],modalStructure:r.a.createElement("form",{onSubmit:this.submitHandler,className:"float-left"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplier"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Supplier Name: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"name",id:"name",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"rif"},"RIF: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"rif",id:"rif",required:!0}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&r.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}]),a}(n.Component)),Z=(a(14),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={supplier:null,product:null,price:null,quantity:null,success:null,error:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.supplierChangeHandler=e.supplierChangeHandler.bind(Object(m.a)(e)),e.productChangeHandler=e.productChangeHandler.bind(Object(m.a)(e)),e.inputChangeHandler=e.inputChangeHandler.bind(Object(m.a)(e)),e.setModalAction=e.setModalAction.bind(Object(m.a)(e)),e.supplierSelect=r.a.createRef(),e.productSelect=r.a.createRef(),e.supplyingForm=r.a.createRef(),e}return Object(d.a)(a,[{key:"setModalAction",value:function(e){this.setState({modalAction:e})}},{key:"supplierChangeHandler",value:function(e){this.setState({supplier:e})}},{key:"productChangeHandler",value:function(e){this.setState({product:e})}},{key:"inputChangeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault(),this.state.supplier&&this.state.product&&this.state.price&&this.state.quantity?fetch("/api/supplyings",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({supplierId:this.state.supplier.id,productId:this.state.product.id,price:this.state.price,quantity:this.state.quantity,dolarReference:this.props.dolarReference})}).then((function(e){200==e.status?(t.setState({success:"Se ha registrado el abastecimiento con \xe9xito"}),t.supplyingForm.current.reset(),Y()("#resourceTable").DataTable().draw()):e.text().then((function(e){t.setState({error:e})}))})):alert("Por favor rellene todos los campos")}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Abastecimiento"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,setModalAction:this.setModalAction,sourceURL:"/api/supplyings",columns:[{title:"ID",data:"id"},{title:"ID Proveedor",data:"supplierId"},{title:"Nombre Proveedor",data:"supplier.name"},{title:"ID Product",data:"productId"},{title:"Nombre Producto",data:"product.name"},{render:function(e){return"$"+e},title:"Precio de Compra",data:"price"},{render:function(e){return e>1?e+" Unidades":e+" Unidad"},title:"Cantidad",data:"quantity"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],actions:["add","edit","delete"],modalStructure:r.a.createElement("form",{ref:this.supplyingForm,onSubmit:this.submitHandler,className:"float-left"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplying"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"supplierId"},"Supplier ID: "),r.a.createElement($.a,{sourceURL:"/api/suppliers",isMulti:!1,innerRef:this.supplierSelect,changeHandler:this.supplierChangeHandler,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"productId"},"Product ID: "),r.a.createElement($.a,{isMulti:!1,innerRef:this.productSelect,changeHandler:this.productChangeHandler,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"price"},"Price: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"number",step:"0.00000000000000001",name:"price",id:"price",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"quantity"},"Quantity: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"number",step:"0.1",name:"quantity",id:"quantity",required:!0}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&r.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}]),a}(n.Component)),X=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={email:null,password:null,permissions:null,success:null,error:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.inputChangeHandler=e.inputChangeHandler.bind(Object(m.a)(e)),e.form=r.a.createRef(),e}return Object(d.a)(a,[{key:"submitHandler",value:function(e){var t=this;e.preventDefault(),this.state.email&&this.state.password&&this.state.permissions&&fetch("/api/users",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password,permissions:this.state.permissions})}).then((function(e){200==e.status?(t.setState({success:"Se ha registrado con \xe9xito"}),t.form.current.reset(),Y()("resourceTable").DataTable().draw()):e.text().then((function(e){t.setState({error:e})}))}))}},{key:"inputChangeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Usuarios"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,sourceURL:"/api/users",columns:[{title:"ID",data:"id"},{title:"Email",data:"email"},{title:"Permisos",data:"permissions"},{title:"Fecha creaci\xf3n",data:"createdAt"}],actions:["add","delete"],modalStructure:r.a.createElement("form",{ref:this.form,onSubmit:this.submitHandler,className:"float-left"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"New Supplier"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"email",id:"email",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"password",name:"password",id:"password",required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"permissions"},"Permissions: "),r.a.createElement("input",{onChange:this.inputChangeHandler,className:"form-control",type:"text",name:"permissions",id:"permissions",required:!0}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Enviar")),this.state.success&&r.a.createElement("span",{className:"text-success"},this.state.success),this.state.error&&r.a.createElement("span",{className:"text-danger"},this.state.error))}))))}}]),a}(n.Component),ee=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).clickHandler=e.clickHandler.bind(Object(m.a)(e)),e.logout=e.logout.bind(Object(m.a)(e)),e}return Object(d.a)(a,[{key:"logout",value:function(){localStorage.removeItem("jwt")}},{key:"clickHandler",value:function(e){this.setState({activeNavLink:e.target.innerText})}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark flex-lg-column flex-xl-row"},r.a.createElement("a",{className:"navbar-brand text-danger",href:"/"},"Supermercado Melquisedec"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse row p-0 m-0",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav flex-lg-row mx-auto container-fluid p-0 m-0"},r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/control-de-ventas"},r.a.createElement("span",{className:"d-md-inline"},"Control de Ventas"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/inventario"},r.a.createElement("span",{className:"d-md-inline"},"Inventario"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/reportes"},r.a.createElement("span",{className:"d-md-inline"},"Reportes"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/deuda"},r.a.createElement("span",{className:"d-md-inline"},"Deuda"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/categorias"},r.a.createElement("span",{className:"d-md-inline"},"Categor\xedas"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/clientes"},r.a.createElement("span",{className:"d-md-inline"},"Clientes"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/productos"},r.a.createElement("span",{className:"d-md-inline"},"Productos"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/ventas"},r.a.createElement("span",{className:"d-md-inline"},"Ventas"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/abastecimiento"},r.a.createElement("span",{className:"d-md-inline"},"Abastecimiento"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/proveedores"},r.a.createElement("span",{className:"d-md-inline"},"Proveedores"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link",onClick:this.clickHandler,to:"/usuarios"},r.a.createElement("span",{className:"d-md-inline"},"Usuarios"))),r.a.createElement("li",{className:"nav-item","data-toggle":"collapse","data-target":"#navbarSupportedContent"},r.a.createElement(l.b,{className:"nav-link btn btn-danger px-0",onClick:this.logout,to:"/signin"},"Cerrar Sesi\xf3n")))))}}]),a}(n.Component),te=a(54),ae=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Inventario"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(J,{asyncTable:!0,sourceURL:"/api/inventory",columns:[{title:"Product ID",data:"id"},{title:"Nombre Producto",data:"name"},{title:"Inventario",data:"stock",render:function(e,t,a){return e<=0?'<span class="text-danger">'.concat(e,"</span>"):'<span class="text-success">'.concat(e,"</span>")}},{title:"Total productos vendidos",data:"salesTotal"},{title:"Total productos comprados",data:"supplyingsTotal"}],actions:[]}))))}}]),a}(n.Component),ne=a(25),re=a(3),se=(a(14),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={resource:"sales",parameters:""},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.changeHandler=e.changeHandler.bind(Object(m.a)(e)),e.reportForm=r.a.createRef(),e.resourceTable=r.a.createRef(),e}return Object(d.a)(a,[{key:"changeHandler",value:function(e){var t=document.body.querySelector("#rangeDateFrom").value,a=document.body.querySelector("#rangeDateTo").value,n=document.body.querySelector("#greaterThanDate").value,r=document.body.querySelector("#lowerThanDate").value,s=document.body.querySelector("#equalDate").value,c=this.state.parameters,l="";if("dateRadios"==e.target.name){switch(re("form").find("input[type=date]").val(""),e.target.id){case"today":l="from=".concat(ne(new Date).format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"));break;case"yesterday":l="from=".concat(ne(new Date).subtract(1,"days").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).subtract(1,"days").format("YYYY-MM-DD"));break;case"lastWeek":l="from=".concat(ne(new Date).subtract(7,"days").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"));break;case"fortnight":l="from=".concat(ne(new Date).subtract(15,"days").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"));break;case"month":l="from=".concat(ne(new Date).subtract(1,"months").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"));break;case"quarter":l="from=".concat(ne(new Date).subtract(3,"months").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"));break;case"semester":l="from=".concat(ne(new Date).subtract(6,"months").format("YYYY-MM-DD"),"&to=").concat(ne(new Date).format("YYYY-MM-DD"))}l+="&group=true"}else{if("reportType"==e.target.name)return void this.setState({resource:e.target.id,parameters:""},(function(){this.setState({parameters:c})}));switch(re("form").find("input[name=dateRadios]").prop("checked",!1),re("form").find("input[type=date]").val(""),e.target.id){case"greaterThanDate":l="createdAt=".concat(n,"&operation=gte"),e.target.value=n;break;case"lowerThanDate":l="createdAt=".concat(r,"&operation=lte"),e.target.value=r;break;case"equalDate":l="createdAt=".concat(s,"&operation=eq"),e.target.value=s;break;case"rangeDateFrom":l=a?"from=".concat(ne(t||"").format("YYYY-MM-DD"),"&to=").concat(a):"from=".concat(ne(t||"").format("YYYY-MM-DD")),e.target.value=t,re("#rangeDateTo").val(a);break;case"rangeDateTo":l=t?"from=".concat(t,"&to=").concat(ne(a||"").format("YYYY-MM-DD")):"to=".concat(ne(a||"").format("YYYY-MM-DD")),e.target.value=a,re("#rangeDateFrom").val(t)}l+="&group=true"}this.setState({parameters:l})}},{key:"componentDidUpdate",value:function(){this.resourceTable.current&&this.resourceTable.current.changeSourceURL("/api/".concat(this.state.resource,"?").concat(this.state.parameters))}},{key:"submitHandler",value:function(e){e.preventDefault(),this.reportForm.current.reset()}},{key:"render",value:function(){var e=[{title:"Product ID",data:"product.id"},{title:"Nombre",data:"product.name"},{title:"Cantidad de productos",data:"salesTotal"},{render:function(e,t,a,n){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.grossTotalDollars)},title:"sales"==this.state.resource?"Ganancia bruta $":"Costo bruto $",data:"grossTotalDollars"},{render:function(e,t,a,n){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.grossTotalBs)},title:"sales"==this.state.resource?"Ganancia bruta Bs":"Costo bruto Bs",data:"grossTotalBs"},{render:function(e,t,a,n){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.netIncomeDollars)},title:"sales"==this.state.resource?"Ganancia Neta $":"Ganancia neta $",data:"netIncomeDollars"},{render:function(e,t,a,n){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.netIncomeBs)},title:(this.state.resource,"Ganancia Neta Bs"),data:"netIncomeBs"}],t=[{title:"Product ID",data:"product.id"},{title:"Nombre",data:"product.name"},{title:"Cantidad de productos",data:"quantity"},{render:function(e,t,a,n){return Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a.grossTotalDollars)},title:"sales"==this.state.resource?"Ganancia bruta $":"Costo bruto $",data:"grossTotalDollars"},{render:function(e,t,a,n){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(a.grossTotalBs)},title:"sales"==this.state.resource?"Ganancia bruta Bs":"Costo bruto Bs",data:"grossTotalBs"}];return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Reportes"))),r.a.createElement("hr",null),r.a.createElement("form",{ref:this.reportForm,onSubmit:this.submitHandler},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("h3",{className:"mr-4"},"Tipo de reporte:")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"reportType",id:"supplyings",value:"supplyingRadio"}),r.a.createElement("label",{className:"form-check-label",htmlFor:"supplyingRadio"},"Compra")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"reportType",id:"sales",value:"saleRadio",defaultChecked:!0}),r.a.createElement("label",{className:"form-check-label",htmlFor:"saleRadio"},"Venta"))),r.a.createElement("hr",{className:"col-12 p-0"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-lg-2"},r.a.createElement("h5",{className:"mr-4"},"Rango de fechas:"),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"rangeDateFrom",id:"rangeDateFrom"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"rangeDateTo",id:"rangeDateTo"}))),r.a.createElement("div",{className:"col-12 col-lg-4"},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"semester",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"semester"}),"6 meses")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"quarter",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"quarter"}),"3 meses")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"month",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"month"}),"1 mes")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"fortnight",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"fortnight"}),"15 d\xedas")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"lastWeek",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"lastWeek"}),"\xdatima semana")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"yesterday",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"yesterday"}),"Ayer")),r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("label",{className:"btn btn-secondary",htmlFor:"today",name:"labelDateRadios"},r.a.createElement("input",{onChange:this.changeHandler,className:"form-check-input",type:"radio",name:"dateRadios",id:"today"}),"Hoy"))),r.a.createElement("div",{className:"col-12 col-lg-2"},r.a.createElement("div",{className:""},r.a.createElement("h5",{className:""},"Fecha mayor o igual a:"),r.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"greaterThanDate",id:"greaterThanDate"}))),r.a.createElement("div",{className:"col-12 col-lg-2"},r.a.createElement("div",{className:""},r.a.createElement("h5",{className:""},"Fecha menor o igual a:"),r.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"lowerThanDate",id:"lowerThanDate"}))),r.a.createElement("div",{className:"col-12 col-lg-2"},r.a.createElement("div",{className:""},r.a.createElement("h5",{className:""},"Fecha igual a:"),r.a.createElement("input",{onChange:this.changeHandler,type:"date",name:"equalDate",id:"equalDate"})))),r.a.createElement("hr",null)),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},""!=this.state.parameters&&r.a.createElement(J,{ref:this.resourceTable,asyncTable:!0,sourceURL:"/api/".concat(this.state.resource,"?").concat(this.state.parameters),columns:"sales"==this.state.resource?e:t,actions:[],dolarReference:this.props.dolarReference}))))}}]),a}(n.Component)),ce={fetchAll:function(){var e=Object(O.a)(T.a.mark((function e(){var t,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/debts",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fetchById:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/debts"+"?id=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fetchByName:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/debts"+"?name=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/debts",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(O.a)(T.a.mark((function e(t){var a,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/debts"+"/".concat(t.id),{method:"PUT",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};a(14);var le=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={fetchMessage:null,submitMessage:null,submitMessageType:null,submitLoading:!1,debtType:0,debtTotal:null,debtAction:null,selectedRowData:null,selectedClient:null},e.submitHandler=e.submitHandler.bind(Object(m.a)(e)),e.changeHandler=e.changeHandler.bind(Object(m.a)(e)),e.optionChangeHandler=e.optionChangeHandler.bind(Object(m.a)(e)),e.debtTable=r.a.createRef(),e.addButton={text:"Add",name:"add",className:"btn btn-success",attr:{"data-toggle":"modal","data-target":"#debtModal"},action:function(t,a,n,r){Y()(".modal-title").text("Add new debt"),Y()("#debtTotal").val(""),e.setState({debtAction:"Add",selectedClient:null})}},e.editButton={text:"Edit",name:"edit",className:"btn btn-secondary",extend:"selected",attr:{"data-toggle":"modal","data-target":"#debtModal"},action:function(t,a,n,r){var s=a.row({selected:!0}).data();Y()(".modal-title").text("Edit debt"),Y()("#debtTotal").val(s.total),e.setState({debtAction:"Edit",selectedRowData:s,selectedClient:{label:s.client.name,value:s.client},debtType:s.type,debtTotal:s.total})}},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(O.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce.fetchAll();case 2:(t=e.sent).data?Y()(this.debtTable.current).DataTable({data:t.data,columns:[{title:"ID",data:"id"},{title:"Client ID",data:"client.id"},{title:"Nombre",data:"client.name"},{title:"C\xe9dula",data:"client.cedula"},{title:"Tel\xe9fono",data:"client.phoneNumber"},{render:function(e){return 0==e?"Deuda":"Credito"},title:"Tipo",data:"type"},{render:function(e){return Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e)},title:"Total",data:"total"},{render:function(e){return 0==e?'<span class="text-danger">SIN PAGAR</span>':'<span class="text-success">PAGADO</span>'},title:"Estado",data:"cancelled"},{title:"Fecha creaci\xf3n",data:"createdAt"},{title:"Fecha actualizaci\xf3n",data:"updatedAt"}],dom:"Blftip",buttons:[this.addButton,this.editButton],select:"single",order:[0,"DESC"]}):this.setState({fetchMessage:t.toString()});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"optionChangeHandler",value:function(e,t){this.setState({selectedClient:e})}},{key:"submitHandler",value:function(e){var t=this;e.preventDefault();var a=null;this.setState({submitLoading:!0},Object(O.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Add"!=t.state.debtAction){e.next=6;break}return e.next=3,ce.create({clientId:t.state.selectedRowData.client.id,type:t.state.debtType,total:t.state.debtTotal});case 3:a=e.sent,e.next=12;break;case 6:if("Edit"!=t.state.debtAction){e.next=12;break}return e.next=9,ce.update({id:t.state.selectedRowData.id,clientId:t.state.selectedRowData.clientId,type:t.state.debtType,total:t.state.debtTotal,cancelled:t.state.selectedRowData.cancelled});case 9:a=e.sent,Y()(t.debtTable.current).DataTable().rows().data().map((function(e,a){if(e.id==t.state.selectedRowData.id){var n=Y()(t.debtTable.current).DataTable().row(a),r=n.data();n.data(Object(B.a)(Object(B.a)({},r),{},{type:t.state.debtType,total:t.state.debtTotal}))}}));case 12:a.error?t.setState({submitMessage:a.error,submitMessageType:"Error",submitLoading:!1}):(t.setState({submitMessage:"Se ha registrado con \xe9xito",submitMessageType:"Success",submitLoading:!1}),setTimeout((function(){t.setState({submitMessage:null,submitMessageType:null})}),3e3));case 13:case"end":return e.stop()}}),e)}))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.fetchMessage&&r.a.createElement("span",{className:"text-danger"},this.state.fetchMessage),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger float-left"},"Deuda"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("table",{ref:this.debtTable,id:"debtTable",name:"debtTable",className:"table table-bordered"}))),r.a.createElement("div",{className:"modal fade",id:"debtModal",tabindex:"-1","aria-labelledby":"debtModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"debtModalLabel"},"Add new debt"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{onSubmit:this.submitHandler},r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Client: "),r.a.createElement($.a,{sourceURL:"/api/clients",value:this.state.selectedClient,changeHandler:this.optionChangeHandler})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Type: "),r.a.createElement("select",{onChange:this.changeHandler,className:"form-control",name:"debtType",id:"debtType"},r.a.createElement("option",{value:"0"},"DEUDA"),r.a.createElement("option",{value:"1"},"CREDITO"))),r.a.createElement("label",{htmlFor:"debtTotal"},"Total: "),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{class:"input-group-prepend"},r.a.createElement("div",{class:"input-group-text"},"Bs")),r.a.createElement("input",{onChange:this.changeHandler,className:"form-control",type:"number",step:"0.01",name:"debtTotal",id:"debtTotal"}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Cerrar"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},this.state.submitLoading&&r.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2",role:"status","aria-hidden":"true"}),"Enviar")),this.state.submitMessage&&r.a.createElement("span",{className:"Error"==this.state.submitMessageType?"text-danger":"text-success"},this.state.submitMessage))))))}}]),a}(n.Component),oe=a(56),ie=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={loading:!0,isAuthenticated:!1},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;R().then((function(t){e.setState({loading:!1,isAuthenticated:t})}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.component,n=Object(oe.a)(t,["component"]);return r.a.createElement(o.b,{render:function(t){return e.state.isAuthenticated?r.a.createElement(a,Object.assign({},t,n)):e.state.loading?r.a.createElement("div",null,"LOADING"):r.a.createElement(o.a,{to:{pathname:"/signin",state:{from:e.props.location}}})}})}}]),a}(r.a.Component),de=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={formattedDolareReference:"",dolarReference:0,loading:!1,newDolarReference:null},e.fetchDolarReference=e.fetchDolarReference.bind(Object(m.a)(e)),e.dolarReferenceSubmitHandler=e.dolarReferenceSubmitHandler.bind(Object(m.a)(e)),e.changeHandler=e.changeHandler.bind(Object(m.a)(e)),e.closeEditDolarModalButton=r.a.createRef(),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.fetchDolarReference()}},{key:"fetchDolarReference",value:function(){var e=this;this.setState({loading:!0}),fetch("/api/dolarReference",{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(t){t.data?e.setState({dolarReference:t.data.price,formattedDolareReference:Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t.data.price),loading:!1}):e.setState({dolarReference:0,formattedDolareReference:Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(0),loading:!1})}))}},{key:"changeHandler",value:function(e){this.setState(Object(A.a)({},e.target.name,e.target.value))}},{key:"dolarReferenceSubmitHandler",value:function(e){e.preventDefault(),fetch("/api/dolarReference",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({price:this.state.newDolarReference})}).then((function(e){204==e.status?window.location.reload():alert("Error")}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row sticky-top"},r.a.createElement("div",{className:"col-md-12 p-0"},r.a.createElement(ee,null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"bg-danger text-light col-12"},"Precio del Dolar ",r.a.createElement("span",{id:"dolarReference",className:"badge badge-light"},this.state.loading?"Loading...":this.state.formattedDolareReference),r.a.createElement("button",{className:"btn btn-secondary ml-4","data-toggle":"modal","data-target":"#dolarEditModal"},"Editar"))),r.a.createElement("main",{className:"mt-5"},r.a.createElement(o.b,{path:"/control-de-ventas",render:function(t){return r.a.createElement(te.a,Object.assign({},t,{dolarReference:e.state.dolarReference}))}}),r.a.createElement(o.b,{path:"/inventario",component:ae}),r.a.createElement(o.b,{path:"/reportes",render:function(t){return r.a.createElement(se,Object.assign({},t,{dolarReference:e.state.dolarReference}))}}),r.a.createElement(o.b,{path:"/deuda",render:function(t){return r.a.createElement(le,Object.assign({},t,{dolarReference:e.state.dolarReference}))}}),r.a.createElement(o.b,{path:"/categorias",component:q}),r.a.createElement(o.b,{path:"/clientes",component:V}),r.a.createElement(o.b,{path:"/productos",render:function(t){return r.a.createElement(W,Object.assign({},t,{dolarReference:e.state.dolarReference}))}}),r.a.createElement(o.b,{path:"/ventas",component:Q}),r.a.createElement(o.b,{path:"/abastecimiento",render:function(t){return r.a.createElement(Z,Object.assign({},t,{dolarReference:e.state.dolarReference}))}}),r.a.createElement(o.b,{path:"/proveedores",component:K}),r.a.createElement(o.b,{path:"/usuarios",component:X})),r.a.createElement("div",{className:"modal fade",id:"dolarEditModal",tabindex:"-1","aria-labelledby":"dolarEditModalLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"dolarEditModalLabel"},"Nuevo precio del dolar"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("form",{onSubmit:this.dolarReferenceSubmitHandler},r.a.createElement("div",{className:"modal-body"},r.a.createElement("input",{name:"newDolarReference",onChange:this.changeHandler,className:"form-control",type:"number",placeholder:"Ingrese el nuevo precio del dolar. Ej: 400000"})),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{ref:this.closeEditDolarModalButton,type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save changes")))))))}}]),a}(n.Component),me=a(28),ue={data:[],next:{},previous:{},loading:!1};var pe={activeCategoryId:0,activeCategoryName:"",data:[]};var he={products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_PRODUCTS":return Object(B.a)(Object(B.a)({},e),{},{data:t.paginatedProducts.data,next:t.paginatedProducts.next,previous:t.paginatedProducts.previous});case"LOADING":return Object(B.a)(Object(B.a)({},e),{},{loading:t.loading});default:return e}},categories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_CATEGORIES":return Object(B.a)(Object(B.a)({},e),{},{data:t.categories});case"SET_ACTIVE_CATEGORY_ID":return Object(B.a)(Object(B.a)({},e),{},{activeCategoryId:t.categoryId});case"SET_ACTIVE_CATEGORY_NAME":return Object(B.a)(Object(B.a)({},e),{},{activeCategoryName:t.categoryName});default:return e}}},be=Object(me.b)(Object(B.a)({},he));const fe=Object(me.c)(be);var ge=function(){return r.a.createElement(y.a,{store:fe},r.a.createElement("div",{className:"App"},r.a.createElement(l.a,null,r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:"/signin",component:M}),r.a.createElement(ie,{path:"/",component:de})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},21:function(e,t,a){"use strict";(function(e){var n=a(4),r=a(5),s=a(1),c=a(7),l=a(6),o=(a(100),a(0)),i=a.n(o),d=a(55),m=function(t){Object(c.a)(o,t);var a=Object(l.a)(o);function o(){var e;return Object(n.a)(this,o),(e=a.call(this)).state={options:[]},e.searchHandler=e.searchHandler.bind(Object(s.a)(e)),e}return Object(r.a)(o,[{key:"roundToNiceNumber",value:function(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}},{key:"searchHandler",value:function(t,a){var n=this;fetch(this.props.sourceURL||"/api/products?name=".concat(t),{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then((function(e){return e.json()})).then((function(t){t.data.length>0&&(t.data.forEach((function(t){if(t.value=t.name,t.image){var a=new e.from(t.image,"binary").toString("base64");t.label=[i.a.createElement("img",{className:"img img-fluid",style:{maxWidth:"40px"},src:"data:image/png;base64,".concat(a)}),"".concat(t.name," (").concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(n.roundToNiceNumber(t.price*n.props.dolarReference)),")")]}else t.label="".concat(t.name," (").concat(Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(n.roundToNiceNumber(t.price*n.props.dolarReference)),")")})),a(t.data))}))}},{key:"render",value:function(){return i.a.createElement(d.a,{loadOptions:this.searchHandler,defaultOptions:!0,placeholder:"Buscar",autoFocus:!0,inputId:"selectedProduct",isMulti:this.props.isMulti,isClearable:!0,ref:this.props.innerRef,name:this.props.name,onChange:this.props.changeHandler,value:this.props.value})}}]),o}(o.Component);t.a=m}).call(this,a(35).Buffer)},24:function(e,t){e.exports={loadProducts:function(e){return{type:"LOAD_PRODUCTS",paginatedProducts:e}},setLoading:function(e){return{type:"LOADING",loading:e}}}},26:function(e,t){e.exports={loadCategories:function(e){return{type:"LOAD_CATEGORIES",categories:e}},setActiveCategoryId:function(e){return{type:"SET_ACTIVE_CATEGORY_ID",categoryId:e}},setActiveCategoryName:function(e){return{type:"SET_ACTIVE_CATEGORY_NAME",categoryName:e}}}},54:function(e,t,a){"use strict";(function(e){var n=a(0),r=a.n(n),s=a(21);a(3);class c extends n.Component{constructor(){super(),this.state={selectedProduct:null,addedProducts:[],subtotalDollars:null,subtotalBs:null,totalDollars:null,totalBs:null,quantity:1,stockError:"",error:"",success:""},this.productsHandler=this.productsHandler.bind(this),this.submitHandler=this.submitHandler.bind(this),this.optionChangeHandler=this.optionChangeHandler.bind(this),this.onChangeHandler=this.onChangeHandler.bind(this),this.clickHandler=this.clickHandler.bind(this),this.saleSubmitButton=r.a.createRef(),this.sendSaleForm=r.a.createRef(),this.quantityInput=r.a.createRef(),this.CustomSelectRef=r.a.createRef(),this.productsTableDiv=r.a.createRef(),this.productsTable=r.a.createRef()}componentDidMount(){let e=document.body.getBoundingClientRect(),t=this.productsTableDiv.current.getBoundingClientRect(),a=e.height-t.top-t.height-30;this.productsTableDiv.current.style.maxHeight=a,document.body.addEventListener("keyup",e=>{let t=e.key;e.ctrlKey&&"Enter"==t&&this.saleSubmitButton.current&&this.saleSubmitButton.current.click()})}optionChangeHandler(e,t){"select-option"==t.action&&(this.quantityInput.current.focus(),this.quantityInput.current.select()),this.setState({selectedProduct:e})}onChangeHandler(e){this.setState({[e.target.name]:e.target.value})}productsHandler(e){e.preventDefault(),null!=this.state.selectedProduct?fetch("/api/inventory/"+this.state.selectedProduct.id,{headers:{Authorization:"Bearer "+localStorage.getItem("jwt")}}).then(e=>e.json()).then(e=>{let t=parseInt(e.data[0].stock);if(t>0&&t>=this.state.quantity){let e=this.state.selectedProduct,t={},n=0;e.discount.length&&(n=e.discount[0].percent),e.discount=n,e.quantity=this.state.quantity||1,e.totalDollars=e.price*e.quantity-e.price*(n/100),e.priceBs=this.roundToNiceNumber(e.price*this.props.dolarReference),e.totalBs=this.roundToNiceNumber(e.priceBs*e.quantity-e.priceBs*(n/100)),n?(e.totalFormattedDollars=r.a.createElement("span",{className:n?"text-danger":""},Intl.NumberFormat("es-VE",{style:"currency",currency:"USD"}).format(e.totalDollars)+` (-${n}%)`),e.totalFormattedBs=r.a.createElement("span",{className:n?"text-danger":""},Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.totalBs)+` (-${n}%)`)):(e.totalFormattedDollars=Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e.totalDollars),e.totalFormattedBs=Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(e.totalBs)),t={id:e.id,name:e.name,price:e.price,priceBs:e.priceBs,quantity:parseInt(e.quantity),totalDollars:e.totalDollars,totalBs:e.totalBs,image:e.image,totalFormattedDollars:e.totalFormattedDollars,totalFormattedBs:e.totalFormattedBs,discount:e.discount},this.CustomSelectRef.current.select.state.value=[],this.quantityInput.current.value=1,this.CustomSelectRef.current.focus();let s=!1;if(this.state.addedProducts.forEach(e=>{t.id==e.id&&(s=!0,e.quantity+=t.quantity)}),s){var a=this.state.addedProducts.findIndex(e=>e.id===t.id);this.setState({addedProducts:[...this.state.addedProducts.slice(0,a),Object.assign({},this.state.addedProducts[a],{...t}),...this.state.addedProducts.slice(a+1)],quantity:1,selectedProduct:null,stockError:""},(function(){console.log(this.state.addedProducts);let e=0,t=0;this.state.addedProducts.map(a=>{e+=parseFloat(a.totalDollars),t+=parseFloat(a.totalBs)}),this.setState({subtotalDollars:e,subtotalBs:t,totalDollars:e,totalBs:t})}))}else this.setState({addedProducts:this.state.addedProducts.concat(t),quantity:1,selectedProduct:null,stockError:""},(function(){let e=0,t=0;this.state.addedProducts.map(a=>{e+=parseFloat(a.totalDollars),t+=parseFloat(a.totalBs)}),this.setState({subtotalDollars:e,subtotalBs:t,totalDollars:e,totalBs:t}),this.productsTable.current.parentElement.scrollTop=this.productsTable.current.scrollHeight}))}else this.setState({stockError:"No hay productos suficientes en el inventario"})}):this.setState({stockError:"Seleccione un producto"})}clickHandler(e){let t=[],a=0,n=0;this.state.addedProducts.forEach(r=>{r.id!=e.currentTarget.parentElement.parentElement.getAttribute("productid")?t.push(r):(a+=r.totalDollars,n+=r.totalBs)}),this.setState({addedProducts:t,subtotalDollars:this.state.subtotalDollars-a,subtotalBs:this.state.subtotalBs-n,totalDollars:this.state.totalDollars-a,totalBs:this.state.totalBs-n}),this.CustomSelectRef.current.focus()}submitHandler(){if(!this.state.addedProducts.length)return void this.setState({stockError:"Seleccione un producto"});this.saleSubmitButton.current.disabled=!0;let e=[];this.state.addedProducts.forEach(t=>{e.push({id:t.id,quantity:t.quantity,price:t.price,dolarReference:this.props.dolarReference,discount:t.discount})}),fetch("/api/sales",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("jwt"),"Content-Type":"application/json"},body:JSON.stringify({products:e})}).then(e=>e.json()).then(e=>{e.err||e.error?this.setState({error:e.err}):(this.setState({success:"La venta se ha realizado con \xe9xito",selectedProduct:null,addedProducts:[],subtotalDollars:null,subtotalBs:null,totalDollars:null,totalBs:null,quantity:1,stockError:"",error:""}),setTimeout(()=>{this.setState({success:""})},3e3),this.CustomSelectRef.current.select.state.value=[],this.quantityInput.current.value=1,this.CustomSelectRef.current.focus(),this.saleSubmitButton.current.disabled=!1)})}roundToNiceNumber(e){var t=0;return 4==e.toString().length?t=100*Math.ceil(e/100):e.toString().length>4&&(t=1e3*Math.ceil(e/1e3)),t}render(){return r.a.createElement("div",{className:"container-fluid",id:"container"},r.a.createElement("div",{className:"row d-none d-lg-inline-block"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("h1",{className:"text-danger"},"Control de Ventas"))),r.a.createElement("div",{className:"row mt-0 mt-lg-5"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("span",{className:"text-danger"},this.state.stockError),r.a.createElement("span",{className:"text-danger h3"},this.state.error),r.a.createElement("span",{className:"text-success h3"},this.state.success))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("form",{className:"",onSubmit:this.productsHandler},r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-12 col-lg-7 mt-2"},r.a.createElement(s.a,{dolarReference:this.props.dolarReference,isMulti:!1,innerRef:this.CustomSelectRef,changeHandler:this.optionChangeHandler,name:"ProductSelect"})),r.a.createElement("div",{className:"col-12 col-lg-3 mt-2"},r.a.createElement("input",{onChange:this.onChangeHandler,ref:this.quantityInput,type:"text",className:"form-control",placeholder:"Cantidad",id:"quantity",name:"quantity",defaultValue:"1"})),r.a.createElement("div",{className:"col-12 col-lg-2 mt-2"},r.a.createElement("input",{type:"submit",className:"form-control btn btn-info",value:"Enviar"})))))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-lg-2"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{ref:this.saleSubmitButton,onClick:this.submitHandler,type:"button",className:"form-control btn btn-primary",value:"Procesar venta"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{ref:this.saleSubmitButton,onClick:this.submitHandler,type:"button",className:"form-control btn btn-warning",value:"Enviar a deuda"}))),r.a.createElement("div",{className:"col-12 col-lg-10"},r.a.createElement("div",{ref:this.productsTableDiv,className:"table-responsive"},r.a.createElement("table",{ref:this.productsTable,className:"table table-dark table-striped overflow-auto"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Count"),r.a.createElement("th",{scope:"col"},"Product ID"),r.a.createElement("th",{scope:"col"},"Nombre"),r.a.createElement("th",{scope:"col"},"Precio $"),r.a.createElement("th",{scope:"col"},"Precio Bs"),r.a.createElement("th",{scope:"col"},"Cantidad"),r.a.createElement("th",{scope:"col"},"Total",r.a.createElement("span",{className:"font-weight-bold text-warning"}," "+Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(this.state.totalDollars))),r.a.createElement("th",{scope:"col"},"Total",r.a.createElement("span",{className:"font-weight-bold text-warning"}," "+Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(this.state.totalBs))))),r.a.createElement("tbody",null,this.state.addedProducts.map((t,a)=>{if(t.image){var n=new e.from(t.image,"binary").toString("base64");return r.a.createElement("tr",{key:a,productid:t.id},r.a.createElement("th",null,a+1),r.a.createElement("th",null,t.id),r.a.createElement("th",null,r.a.createElement("img",{className:"",style:{maxWidth:"40px"},src:"data:image/png;base64,"+n}),t.name),r.a.createElement("th",null,Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.price)),r.a.createElement("th",null,Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t.priceBs)),r.a.createElement("th",null,t.quantity),r.a.createElement("th",null,t.totalFormattedDollars),r.a.createElement("th",null,t.totalFormattedBs),r.a.createElement("th",null,r.a.createElement("button",{onClick:this.clickHandler,className:"btn btn-danger p-0"},"Delete")))}return r.a.createElement("tr",{key:a,productid:t.id},r.a.createElement("th",null,a+1),r.a.createElement("th",null,t.id),r.a.createElement("th",null,t.name),r.a.createElement("th",null,Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.price)),r.a.createElement("th",null,Intl.NumberFormat("es-VE",{style:"currency",currency:"VES"}).format(t.priceBs)),r.a.createElement("th",null,t.quantity),r.a.createElement("th",null,t.totalFormattedDollars),r.a.createElement("th",null,t.totalFormattedBs),r.a.createElement("th",null,r.a.createElement("button",{onClick:this.clickHandler,className:"btn btn-danger p-0"},"Delete")))})),r.a.createElement("tfoot",null))))))}}t.a=c}).call(this,a(35).Buffer)},57:function(e,t,a){e.exports=a(107)},63:function(e,t,a){},64:function(e,t,a){}},[[57,1,2]]]);
//# sourceMappingURL=main.9144fcd4.chunk.js.map